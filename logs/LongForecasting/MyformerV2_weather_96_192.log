Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='96_192', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=192, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_96_192_MyformerV2_custom_ftM_sl96_ll48_pl192_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6658659
	speed: 0.3459s/iter; left time: 1940.9358s
	iters: 200, epoch: 1 | loss: 0.8720788
	speed: 0.3600s/iter; left time: 1984.1952s
	iters: 300, epoch: 1 | loss: 0.5751018
	speed: 0.3622s/iter; left time: 1960.0278s
	iters: 400, epoch: 1 | loss: 0.8651456
	speed: 0.3545s/iter; left time: 1882.4996s
	iters: 500, epoch: 1 | loss: 0.5769609
	speed: 0.3507s/iter; left time: 1827.5560s
Epoch: 1 cost time: 202.91865181922913
Epoch: 1, Steps: 571 | Train Loss: 0.5935945 Vali Loss: 0.5268079 Test Loss: 0.2328198
Validation loss decreased (inf --> 0.526808).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7092150
	speed: 1.7871s/iter; left time: 9007.2346s
	iters: 200, epoch: 2 | loss: 0.4972471
	speed: 0.3604s/iter; left time: 1780.5027s
	iters: 300, epoch: 2 | loss: 0.6525995
	speed: 0.3525s/iter; left time: 1706.2882s
	iters: 400, epoch: 2 | loss: 0.6237981
	speed: 0.3505s/iter; left time: 1661.5559s
	iters: 500, epoch: 2 | loss: 0.4888602
	speed: 0.3588s/iter; left time: 1664.9389s
Epoch: 2 cost time: 202.37324786186218
Epoch: 2, Steps: 571 | Train Loss: 0.5598103 Vali Loss: 0.5184801 Test Loss: 0.2294693
Validation loss decreased (0.526808 --> 0.518480).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6625522
	speed: 1.8238s/iter; left time: 8150.3505s
	iters: 200, epoch: 3 | loss: 0.4600289
	speed: 0.3494s/iter; left time: 1526.4957s
	iters: 300, epoch: 3 | loss: 0.8861565
	speed: 0.3593s/iter; left time: 1533.7541s
	iters: 400, epoch: 3 | loss: 0.4436200
	speed: 0.3577s/iter; left time: 1491.4461s
	iters: 500, epoch: 3 | loss: 0.4074994
	speed: 0.3343s/iter; left time: 1360.0636s
Epoch: 3 cost time: 200.25990509986877
Epoch: 3, Steps: 571 | Train Loss: 0.5419683 Vali Loss: 0.4998315 Test Loss: 0.2255985
Validation loss decreased (0.518480 --> 0.499831).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4011196
	speed: 1.9276s/iter; left time: 7513.8972s
	iters: 200, epoch: 4 | loss: 0.4670842
	speed: 0.3545s/iter; left time: 1346.3127s
	iters: 300, epoch: 4 | loss: 0.4191180
	speed: 0.3608s/iter; left time: 1334.3002s
	iters: 400, epoch: 4 | loss: 0.3893130
	speed: 0.3251s/iter; left time: 1169.8193s
	iters: 500, epoch: 4 | loss: 0.4212287
	speed: 0.3116s/iter; left time: 1089.9645s
Epoch: 4 cost time: 192.7211172580719
Epoch: 4, Steps: 571 | Train Loss: 0.5322696 Vali Loss: 0.4878040 Test Loss: 0.2187257
Validation loss decreased (0.499831 --> 0.487804).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4521164
	speed: 1.9565s/iter; left time: 6509.3079s
	iters: 200, epoch: 5 | loss: 0.4457632
	speed: 0.3406s/iter; left time: 1099.0915s
	iters: 300, epoch: 5 | loss: 0.4874547
	speed: 0.3217s/iter; left time: 1005.9381s
	iters: 400, epoch: 5 | loss: 0.4110378
	speed: 0.2934s/iter; left time: 888.0148s
	iters: 500, epoch: 5 | loss: 0.8691429
	speed: 0.2950s/iter; left time: 863.6110s
Epoch: 5 cost time: 181.45697355270386
Epoch: 5, Steps: 571 | Train Loss: 0.5269793 Vali Loss: 0.4816195 Test Loss: 0.2168759
Validation loss decreased (0.487804 --> 0.481620).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5342025
	speed: 2.0180s/iter; left time: 5561.5476s
	iters: 200, epoch: 6 | loss: 0.4683173
	speed: 0.3361s/iter; left time: 892.6850s
	iters: 300, epoch: 6 | loss: 0.6705795
	speed: 0.2966s/iter; left time: 758.1040s
	iters: 400, epoch: 6 | loss: 0.6797805
	speed: 0.2984s/iter; left time: 732.9388s
	iters: 500, epoch: 6 | loss: 0.4288531
	speed: 0.2867s/iter; left time: 675.5324s
Epoch: 6 cost time: 175.9285957813263
Epoch: 6, Steps: 571 | Train Loss: 0.5244374 Vali Loss: 0.4783408 Test Loss: 0.2159569
Validation loss decreased (0.481620 --> 0.478341).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7431923
	speed: 1.4086s/iter; left time: 3077.8052s
	iters: 200, epoch: 7 | loss: 0.4740463
	speed: 0.2711s/iter; left time: 565.1405s
	iters: 300, epoch: 7 | loss: 0.4299465
	speed: 0.2616s/iter; left time: 519.2138s
	iters: 400, epoch: 7 | loss: 0.3897539
	speed: 0.2683s/iter; left time: 505.7444s
	iters: 500, epoch: 7 | loss: 0.3429505
	speed: 0.2644s/iter; left time: 471.9020s
Epoch: 7 cost time: 155.2625834941864
Epoch: 7, Steps: 571 | Train Loss: 0.5228867 Vali Loss: 0.4779422 Test Loss: 0.2154485
Validation loss decreased (0.478341 --> 0.477942).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4777814
	speed: 1.5453s/iter; left time: 2494.1514s
	iters: 200, epoch: 8 | loss: 0.5862189
	speed: 0.2636s/iter; left time: 399.1124s
	iters: 300, epoch: 8 | loss: 0.6392320
	speed: 0.2640s/iter; left time: 373.3639s
	iters: 400, epoch: 8 | loss: 0.7154594
	speed: 0.2691s/iter; left time: 353.5608s
	iters: 500, epoch: 8 | loss: 0.4224594
	speed: 0.2674s/iter; left time: 324.6484s
Epoch: 8 cost time: 156.89854550361633
Epoch: 8, Steps: 571 | Train Loss: 0.5217856 Vali Loss: 0.4780607 Test Loss: 0.2150218
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4284954
	speed: 1.4098s/iter; left time: 1470.4626s
	iters: 200, epoch: 9 | loss: 0.4754875
	speed: 0.2598s/iter; left time: 245.0349s
	iters: 300, epoch: 9 | loss: 0.4226508
	speed: 0.2596s/iter; left time: 218.8358s
	iters: 400, epoch: 9 | loss: 0.4764269
	speed: 0.2703s/iter; left time: 200.8486s
	iters: 500, epoch: 9 | loss: 0.4205396
	speed: 0.2624s/iter; left time: 168.7027s
Epoch: 9 cost time: 152.03586745262146
Epoch: 9, Steps: 571 | Train Loss: 0.5217814 Vali Loss: 0.4786539 Test Loss: 0.2148039
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4579231
	speed: 1.3759s/iter; left time: 649.4385s
	iters: 200, epoch: 10 | loss: 0.6551310
	speed: 0.2592s/iter; left time: 96.4298s
	iters: 300, epoch: 10 | loss: 0.4845210
	speed: 0.2528s/iter; left time: 68.7538s
	iters: 400, epoch: 10 | loss: 0.4684893
	speed: 0.2358s/iter; left time: 40.5563s
	iters: 500, epoch: 10 | loss: 0.4692267
	speed: 0.2425s/iter; left time: 17.4598s
Epoch: 10 cost time: 143.27263593673706
Epoch: 10, Steps: 571 | Train Loss: 0.5217610 Vali Loss: 0.4762762 Test Loss: 0.2149032
Validation loss decreased (0.477942 --> 0.476276).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_96_192_MyformerV2_custom_ftM_sl96_ll48_pl192_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 1, 192, 21) (10348, 1, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.21490302681922913, mae:0.2556952238082886
