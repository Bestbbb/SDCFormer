Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='weather_96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4022932
	speed: 0.1213s/iter; left time: 682.8719s
	iters: 200, epoch: 1 | loss: 0.3831584
	speed: 0.0731s/iter; left time: 404.1641s
	iters: 300, epoch: 1 | loss: 0.2992042
	speed: 0.0727s/iter; left time: 394.9612s
	iters: 400, epoch: 1 | loss: 0.3589250
	speed: 0.0726s/iter; left time: 386.8928s
	iters: 500, epoch: 1 | loss: 0.4015507
	speed: 0.0716s/iter; left time: 374.3054s
Epoch: 1 cost time: 46.617573499679565
Epoch: 1, Steps: 573 | Train Loss: 0.5198363 Vali Loss: 0.4536722 Test Loss: 0.1809551
Validation loss decreased (inf --> 0.453672).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4951672
	speed: 0.8264s/iter; left time: 4179.8682s
	iters: 200, epoch: 2 | loss: 0.4563109
	speed: 0.0726s/iter; left time: 360.1705s
	iters: 300, epoch: 2 | loss: 0.3584579
	speed: 0.0746s/iter; left time: 362.3075s
	iters: 400, epoch: 2 | loss: 0.7760080
	speed: 0.0730s/iter; left time: 347.4728s
	iters: 500, epoch: 2 | loss: 0.5993758
	speed: 0.0735s/iter; left time: 342.2222s
Epoch: 2 cost time: 43.88778066635132
Epoch: 2, Steps: 573 | Train Loss: 0.4902375 Vali Loss: 0.4404170 Test Loss: 0.1786978
Validation loss decreased (0.453672 --> 0.440417).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4597957
	speed: 0.8262s/iter; left time: 3705.6844s
	iters: 200, epoch: 3 | loss: 0.5175374
	speed: 0.0742s/iter; left time: 325.2636s
	iters: 300, epoch: 3 | loss: 0.3519860
	speed: 0.0740s/iter; left time: 317.1330s
	iters: 400, epoch: 3 | loss: 0.4907880
	speed: 0.0750s/iter; left time: 314.0555s
	iters: 500, epoch: 3 | loss: 0.4257259
	speed: 0.0758s/iter; left time: 309.5571s
Epoch: 3 cost time: 44.64090299606323
Epoch: 3, Steps: 573 | Train Loss: 0.4762146 Vali Loss: 0.4359689 Test Loss: 0.1753813
Validation loss decreased (0.440417 --> 0.435969).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3276111
	speed: 0.8433s/iter; left time: 3298.9058s
	iters: 200, epoch: 4 | loss: 0.3553954
	speed: 0.0735s/iter; left time: 280.3677s
	iters: 300, epoch: 4 | loss: 0.3212420
	speed: 0.0734s/iter; left time: 272.3335s
	iters: 400, epoch: 4 | loss: 0.4522956
	speed: 0.0730s/iter; left time: 263.5889s
	iters: 500, epoch: 4 | loss: 0.4233140
	speed: 0.0731s/iter; left time: 256.7888s
Epoch: 4 cost time: 43.69380855560303
Epoch: 4, Steps: 573 | Train Loss: 0.4700539 Vali Loss: 0.4316641 Test Loss: 0.1746410
Validation loss decreased (0.435969 --> 0.431664).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4924472
	speed: 0.8775s/iter; left time: 2929.8610s
	iters: 200, epoch: 5 | loss: 0.3217579
	speed: 0.0735s/iter; left time: 238.1345s
	iters: 300, epoch: 5 | loss: 0.3006231
	speed: 0.0745s/iter; left time: 233.9519s
	iters: 400, epoch: 5 | loss: 0.8456407
	speed: 0.0740s/iter; left time: 224.9305s
	iters: 500, epoch: 5 | loss: 0.9265745
	speed: 0.0724s/iter; left time: 212.6526s
Epoch: 5 cost time: 44.163150787353516
Epoch: 5, Steps: 573 | Train Loss: 0.4674521 Vali Loss: 0.4314216 Test Loss: 0.1733194
Validation loss decreased (0.431664 --> 0.431422).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3938109
	speed: 0.8770s/iter; left time: 2425.6710s
	iters: 200, epoch: 6 | loss: 1.4525867
	speed: 0.0732s/iter; left time: 195.1637s
	iters: 300, epoch: 6 | loss: 0.3756771
	speed: 0.0733s/iter; left time: 187.9625s
	iters: 400, epoch: 6 | loss: 0.8644325
	speed: 0.0726s/iter; left time: 178.9522s
	iters: 500, epoch: 6 | loss: 0.3786023
	speed: 0.0743s/iter; left time: 175.7179s
Epoch: 6 cost time: 44.148088693618774
Epoch: 6, Steps: 573 | Train Loss: 0.4658951 Vali Loss: 0.4331803 Test Loss: 0.1742976
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3786597
	speed: 0.8455s/iter; left time: 1854.1846s
	iters: 200, epoch: 7 | loss: 0.3513584
	speed: 0.0718s/iter; left time: 150.3062s
	iters: 300, epoch: 7 | loss: 0.3641608
	speed: 0.0731s/iter; left time: 145.6755s
	iters: 400, epoch: 7 | loss: 0.7959172
	speed: 0.0702s/iter; left time: 132.9145s
	iters: 500, epoch: 7 | loss: 0.3234213
	speed: 0.0712s/iter; left time: 127.5938s
Epoch: 7 cost time: 42.977439641952515
Epoch: 7, Steps: 573 | Train Loss: 0.4651091 Vali Loss: 0.4315748 Test Loss: 0.1733547
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3125760
	speed: 0.8803s/iter; left time: 1426.0752s
	iters: 200, epoch: 8 | loss: 0.2918199
	speed: 0.0736s/iter; left time: 111.8215s
	iters: 300, epoch: 8 | loss: 0.8518559
	speed: 0.0738s/iter; left time: 104.8571s
	iters: 400, epoch: 8 | loss: 0.4293617
	speed: 0.0722s/iter; left time: 95.2526s
	iters: 500, epoch: 8 | loss: 0.7549132
	speed: 0.0732s/iter; left time: 89.2603s
Epoch: 8 cost time: 43.95263648033142
Epoch: 8, Steps: 573 | Train Loss: 0.4648370 Vali Loss: 0.4313110 Test Loss: 0.1738595
Validation loss decreased (0.431422 --> 0.431311).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3030171
	speed: 0.8425s/iter; left time: 882.0720s
	iters: 200, epoch: 9 | loss: 0.4033147
	speed: 0.0728s/iter; left time: 68.9780s
	iters: 300, epoch: 9 | loss: 0.3521683
	speed: 0.0737s/iter; left time: 62.4258s
	iters: 400, epoch: 9 | loss: 0.8322074
	speed: 0.0754s/iter; left time: 56.3004s
	iters: 500, epoch: 9 | loss: 0.3758990
	speed: 0.0750s/iter; left time: 48.5075s
Epoch: 9 cost time: 44.47991466522217
Epoch: 9, Steps: 573 | Train Loss: 0.4643778 Vali Loss: 0.4312888 Test Loss: 0.1737097
Validation loss decreased (0.431311 --> 0.431289).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3791509
	speed: 0.8794s/iter; left time: 416.8548s
	iters: 200, epoch: 10 | loss: 0.4443589
	speed: 0.0716s/iter; left time: 26.7826s
	iters: 300, epoch: 10 | loss: 0.5259564
	speed: 0.0739s/iter; left time: 20.2365s
	iters: 400, epoch: 10 | loss: 0.3860781
	speed: 0.0739s/iter; left time: 12.8523s
	iters: 500, epoch: 10 | loss: 0.9134986
	speed: 0.0749s/iter; left time: 5.5395s
Epoch: 10 cost time: 44.16293549537659
Epoch: 10, Steps: 573 | Train Loss: 0.4643919 Vali Loss: 0.4303316 Test Loss: 0.1735710
Validation loss decreased (0.431289 --> 0.430332).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17357107996940613, mae:0.2155085951089859
