Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='weather_96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.7914795
	speed: 0.5704s/iter; left time: 3211.9860s
	iters: 200, epoch: 1 | loss: 0.6976067
	speed: 0.5061s/iter; left time: 2799.2108s
	iters: 300, epoch: 1 | loss: 0.6219339
	speed: 0.4923s/iter; left time: 2673.4685s
	iters: 400, epoch: 1 | loss: 0.6122658
	speed: 0.4921s/iter; left time: 2623.2316s
	iters: 500, epoch: 1 | loss: 0.7311427
	speed: 0.4932s/iter; left time: 2579.8140s
Epoch: 1 cost time: 291.50733757019043
Epoch: 1, Steps: 573 | Train Loss: 0.7349320 Vali Loss: 0.5225564 Test Loss: 0.2093813
Validation loss decreased (inf --> 0.522556).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6635777
	speed: 2.3715s/iter; left time: 11995.1663s
	iters: 200, epoch: 2 | loss: 0.6309500
	speed: 0.4881s/iter; left time: 2419.9411s
	iters: 300, epoch: 2 | loss: 0.5832959
	speed: 0.4925s/iter; left time: 2392.3328s
	iters: 400, epoch: 2 | loss: 0.6250337
	speed: 0.4991s/iter; left time: 2374.6257s
	iters: 500, epoch: 2 | loss: 0.5771716
	speed: 0.4967s/iter; left time: 2313.7768s
Epoch: 2 cost time: 284.8315362930298
Epoch: 2, Steps: 573 | Train Loss: 0.6875004 Vali Loss: 0.5098216 Test Loss: 0.2044436
Validation loss decreased (0.522556 --> 0.509822).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6111561
	speed: 2.3949s/iter; left time: 10741.0252s
	iters: 200, epoch: 3 | loss: 0.5521930
	speed: 0.5020s/iter; left time: 2201.2079s
	iters: 300, epoch: 3 | loss: 0.5519675
	speed: 0.5037s/iter; left time: 2158.4905s
	iters: 400, epoch: 3 | loss: 0.7157767
	speed: 0.4935s/iter; left time: 2065.2346s
	iters: 500, epoch: 3 | loss: 0.5118253
	speed: 0.4999s/iter; left time: 2041.9344s
Epoch: 3 cost time: 288.06922125816345
Epoch: 3, Steps: 573 | Train Loss: 0.6546917 Vali Loss: 0.4950942 Test Loss: 0.2004286
Validation loss decreased (0.509822 --> 0.495094).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5976213
	speed: 2.3562s/iter; left time: 9217.6390s
	iters: 200, epoch: 4 | loss: 1.2525616
	speed: 0.4829s/iter; left time: 1840.7150s
	iters: 300, epoch: 4 | loss: 0.6316264
	speed: 0.4725s/iter; left time: 1753.8344s
	iters: 400, epoch: 4 | loss: 0.9913993
	speed: 0.4718s/iter; left time: 1704.0543s
	iters: 500, epoch: 4 | loss: 1.0101298
	speed: 0.4919s/iter; left time: 1727.5968s
Epoch: 4 cost time: 276.85877299308777
Epoch: 4, Steps: 573 | Train Loss: 0.6393604 Vali Loss: 0.4823157 Test Loss: 0.1951467
Validation loss decreased (0.495094 --> 0.482316).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4991146
	speed: 2.3774s/iter; left time: 7938.2379s
	iters: 200, epoch: 5 | loss: 0.8223739
	speed: 0.4964s/iter; left time: 1607.9467s
	iters: 300, epoch: 5 | loss: 0.8664225
	speed: 0.5046s/iter; left time: 1583.9709s
	iters: 400, epoch: 5 | loss: 0.4968039
	speed: 0.5190s/iter; left time: 1577.2255s
	iters: 500, epoch: 5 | loss: 0.5084424
	speed: 0.5212s/iter; left time: 1531.8211s
Epoch: 5 cost time: 292.04875326156616
Epoch: 5, Steps: 573 | Train Loss: 0.6327158 Vali Loss: 0.4762823 Test Loss: 0.1938516
Validation loss decreased (0.482316 --> 0.476282).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6450736
	speed: 2.4741s/iter; left time: 6843.2808s
	iters: 200, epoch: 6 | loss: 0.6942140
	speed: 0.5209s/iter; left time: 1388.6884s
	iters: 300, epoch: 6 | loss: 1.0468674
	speed: 0.5270s/iter; left time: 1352.1712s
	iters: 400, epoch: 6 | loss: 0.5732431
	speed: 0.5007s/iter; left time: 1234.6623s
	iters: 500, epoch: 6 | loss: 0.5161015
	speed: 0.5129s/iter; left time: 1213.4096s
Epoch: 6 cost time: 297.6188006401062
Epoch: 6, Steps: 573 | Train Loss: 0.6297339 Vali Loss: 0.4809592 Test Loss: 0.1930202
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5227481
	speed: 2.5654s/iter; left time: 5625.9106s
	iters: 200, epoch: 7 | loss: 0.4733779
	speed: 0.4802s/iter; left time: 1005.0553s
	iters: 300, epoch: 7 | loss: 0.6199882
	speed: 0.4898s/iter; left time: 976.1068s
	iters: 400, epoch: 7 | loss: 0.6144840
	speed: 0.5115s/iter; left time: 968.2924s
	iters: 500, epoch: 7 | loss: 0.5954682
	speed: 0.5038s/iter; left time: 903.3749s
Epoch: 7 cost time: 286.0524425506592
Epoch: 7, Steps: 573 | Train Loss: 0.6276218 Vali Loss: 0.4761394 Test Loss: 0.1931028
Validation loss decreased (0.476282 --> 0.476139).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 1.0297984
	speed: 2.5507s/iter; left time: 4132.0868s
	iters: 200, epoch: 8 | loss: 0.6176329
	speed: 0.4994s/iter; left time: 759.0723s
	iters: 300, epoch: 8 | loss: 0.6829264
	speed: 0.4812s/iter; left time: 683.2559s
	iters: 400, epoch: 8 | loss: 0.5647746
	speed: 0.4875s/iter; left time: 643.4798s
	iters: 500, epoch: 8 | loss: 0.4318431
	speed: 0.4850s/iter; left time: 591.6747s
Epoch: 8 cost time: 286.3638460636139
Epoch: 8, Steps: 573 | Train Loss: 0.6268445 Vali Loss: 0.4752828 Test Loss: 0.1926229
Validation loss decreased (0.476139 --> 0.475283).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5981811
	speed: 2.5560s/iter; left time: 2676.0879s
	iters: 200, epoch: 9 | loss: 0.5338407
	speed: 0.5281s/iter; left time: 500.0850s
	iters: 300, epoch: 9 | loss: 0.6228162
	speed: 0.5370s/iter; left time: 454.8206s
	iters: 400, epoch: 9 | loss: 0.5661964
	speed: 0.5364s/iter; left time: 400.6774s
	iters: 500, epoch: 9 | loss: 1.0204893
	speed: 0.5306s/iter; left time: 343.3223s
Epoch: 9 cost time: 305.80040073394775
Epoch: 9, Steps: 573 | Train Loss: 0.6262050 Vali Loss: 0.4774955 Test Loss: 0.1927527
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5756797
	speed: 2.5899s/iter; left time: 1227.6336s
	iters: 200, epoch: 10 | loss: 0.5300756
	speed: 0.5343s/iter; left time: 199.8307s
	iters: 300, epoch: 10 | loss: 0.5330110
	speed: 0.5280s/iter; left time: 144.6831s
	iters: 400, epoch: 10 | loss: 0.6863968
	speed: 0.5316s/iter; left time: 92.4989s
	iters: 500, epoch: 10 | loss: 1.1175548
	speed: 0.5373s/iter; left time: 39.7582s
Epoch: 10 cost time: 305.8080198764801
Epoch: 10, Steps: 573 | Train Loss: 0.6257284 Vali Loss: 0.4746361 Test Loss: 0.1927202
Validation loss decreased (0.475283 --> 0.474636).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1927201896905899, mae:0.23459938168525696
