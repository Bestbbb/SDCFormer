Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='weather_96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4226849
	speed: 0.2075s/iter; left time: 1168.2542s
	iters: 200, epoch: 1 | loss: 0.4169085
	speed: 0.1703s/iter; left time: 942.0739s
	iters: 300, epoch: 1 | loss: 0.3871220
	speed: 0.1677s/iter; left time: 910.5969s
	iters: 400, epoch: 1 | loss: 0.3689673
	speed: 0.1670s/iter; left time: 890.1669s
	iters: 500, epoch: 1 | loss: 0.3252238
	speed: 0.1618s/iter; left time: 846.2595s
Epoch: 1 cost time: 99.68174386024475
Epoch: 1, Steps: 573 | Train Loss: 0.5215272 Vali Loss: 0.4531513 Test Loss: 0.1874696
Validation loss decreased (inf --> 0.453151).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3813040
	speed: 1.7115s/iter; left time: 8656.7446s
	iters: 200, epoch: 2 | loss: 0.4691399
	speed: 0.1700s/iter; left time: 842.9232s
	iters: 300, epoch: 2 | loss: 0.3859550
	speed: 0.1717s/iter; left time: 834.2804s
	iters: 400, epoch: 2 | loss: 0.5752307
	speed: 0.1728s/iter; left time: 822.1561s
	iters: 500, epoch: 2 | loss: 0.3329889
	speed: 0.1689s/iter; left time: 786.8734s
Epoch: 2 cost time: 98.63294219970703
Epoch: 2, Steps: 573 | Train Loss: 0.4760317 Vali Loss: 0.4317001 Test Loss: 0.1853481
Validation loss decreased (0.453151 --> 0.431700).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4016862
	speed: 1.7036s/iter; left time: 7640.8560s
	iters: 200, epoch: 3 | loss: 0.5570136
	speed: 0.1617s/iter; left time: 709.0846s
	iters: 300, epoch: 3 | loss: 0.8861271
	speed: 0.1672s/iter; left time: 716.6117s
	iters: 400, epoch: 3 | loss: 0.3835699
	speed: 0.1719s/iter; left time: 719.5616s
	iters: 500, epoch: 3 | loss: 0.3691359
	speed: 0.1629s/iter; left time: 665.4317s
Epoch: 3 cost time: 96.47207903862
Epoch: 3, Steps: 573 | Train Loss: 0.4561290 Vali Loss: 0.4227878 Test Loss: 0.1801970
Validation loss decreased (0.431700 --> 0.422788).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3290029
	speed: 1.7039s/iter; left time: 6665.5975s
	iters: 200, epoch: 4 | loss: 0.4001898
	speed: 0.1601s/iter; left time: 610.4152s
	iters: 300, epoch: 4 | loss: 0.3434090
	speed: 0.1612s/iter; left time: 598.5159s
	iters: 400, epoch: 4 | loss: 0.3398226
	speed: 0.1615s/iter; left time: 583.3416s
	iters: 500, epoch: 4 | loss: 0.4639589
	speed: 0.1601s/iter; left time: 562.2259s
Epoch: 4 cost time: 93.85527658462524
Epoch: 4, Steps: 573 | Train Loss: 0.4467953 Vali Loss: 0.4156851 Test Loss: 0.1780756
Validation loss decreased (0.422788 --> 0.415685).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3305025
	speed: 1.7195s/iter; left time: 5741.5183s
	iters: 200, epoch: 5 | loss: 0.3468896
	speed: 0.1645s/iter; left time: 532.6972s
	iters: 300, epoch: 5 | loss: 0.3166538
	speed: 0.1653s/iter; left time: 518.8899s
	iters: 400, epoch: 5 | loss: 0.6819582
	speed: 0.1601s/iter; left time: 486.5725s
	iters: 500, epoch: 5 | loss: 0.4426694
	speed: 0.1602s/iter; left time: 470.7627s
Epoch: 5 cost time: 95.2473349571228
Epoch: 5, Steps: 573 | Train Loss: 0.4422946 Vali Loss: 0.4128657 Test Loss: 0.1775221
Validation loss decreased (0.415685 --> 0.412866).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3687715
	speed: 1.7151s/iter; left time: 4744.0069s
	iters: 200, epoch: 6 | loss: 0.2664259
	speed: 0.1687s/iter; left time: 449.8377s
	iters: 300, epoch: 6 | loss: 0.3426313
	speed: 0.1592s/iter; left time: 408.4590s
	iters: 400, epoch: 6 | loss: 0.8476971
	speed: 0.1668s/iter; left time: 411.4290s
	iters: 500, epoch: 6 | loss: 0.3201926
	speed: 0.1661s/iter; left time: 392.9267s
Epoch: 6 cost time: 95.55934548377991
Epoch: 6, Steps: 573 | Train Loss: 0.4395446 Vali Loss: 0.4110128 Test Loss: 0.1763704
Validation loss decreased (0.412866 --> 0.411013).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3337651
	speed: 1.7145s/iter; left time: 3759.9984s
	iters: 200, epoch: 7 | loss: 0.3360757
	speed: 0.1707s/iter; left time: 357.3467s
	iters: 300, epoch: 7 | loss: 0.4054826
	speed: 0.1642s/iter; left time: 327.1784s
	iters: 400, epoch: 7 | loss: 0.8641869
	speed: 0.1624s/iter; left time: 307.4952s
	iters: 500, epoch: 7 | loss: 0.2762724
	speed: 0.1610s/iter; left time: 288.6213s
Epoch: 7 cost time: 96.36245322227478
Epoch: 7, Steps: 573 | Train Loss: 0.4383628 Vali Loss: 0.4116699 Test Loss: 0.1769577
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3795075
	speed: 1.7098s/iter; left time: 2769.8832s
	iters: 200, epoch: 8 | loss: 0.6106079
	speed: 0.1614s/iter; left time: 245.2984s
	iters: 300, epoch: 8 | loss: 0.3139507
	speed: 0.1635s/iter; left time: 232.1124s
	iters: 400, epoch: 8 | loss: 0.3504452
	speed: 0.1642s/iter; left time: 216.7311s
	iters: 500, epoch: 8 | loss: 0.4237051
	speed: 0.1599s/iter; left time: 195.0859s
Epoch: 8 cost time: 94.58154344558716
Epoch: 8, Steps: 573 | Train Loss: 0.4377222 Vali Loss: 0.4097585 Test Loss: 0.1758931
Validation loss decreased (0.411013 --> 0.409759).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4289694
	speed: 1.7082s/iter; left time: 1788.5029s
	iters: 200, epoch: 9 | loss: 0.4148780
	speed: 0.1628s/iter; left time: 154.1554s
	iters: 300, epoch: 9 | loss: 0.4193273
	speed: 0.1630s/iter; left time: 138.0655s
	iters: 400, epoch: 9 | loss: 0.3288069
	speed: 0.1686s/iter; left time: 125.9719s
	iters: 500, epoch: 9 | loss: 0.4586519
	speed: 0.1601s/iter; left time: 103.5542s
Epoch: 9 cost time: 94.41899347305298
Epoch: 9, Steps: 573 | Train Loss: 0.4373797 Vali Loss: 0.4072194 Test Loss: 0.1760319
Validation loss decreased (0.409759 --> 0.407219).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3503581
	speed: 1.7054s/iter; left time: 808.3365s
	iters: 200, epoch: 10 | loss: 0.7871779
	speed: 0.1608s/iter; left time: 60.1430s
	iters: 300, epoch: 10 | loss: 0.3262825
	speed: 0.1696s/iter; left time: 46.4764s
	iters: 400, epoch: 10 | loss: 0.4235073
	speed: 0.1705s/iter; left time: 29.6720s
	iters: 500, epoch: 10 | loss: 0.4157060
	speed: 0.1712s/iter; left time: 12.6680s
Epoch: 10 cost time: 96.59077215194702
Epoch: 10, Steps: 573 | Train Loss: 0.4371418 Vali Loss: 0.4115077 Test Loss: 0.1758330
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17603188753128052, mae:0.22018155455589294
