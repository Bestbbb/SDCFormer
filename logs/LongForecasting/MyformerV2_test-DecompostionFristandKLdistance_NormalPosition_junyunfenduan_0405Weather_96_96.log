Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='weather_96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5789891
	speed: 0.1885s/iter; left time: 1061.6778s
	iters: 200, epoch: 1 | loss: 0.5110957
	speed: 0.1496s/iter; left time: 827.5598s
	iters: 300, epoch: 1 | loss: 0.4796968
	speed: 0.1499s/iter; left time: 814.2175s
	iters: 400, epoch: 1 | loss: 0.3741693
	speed: 0.1381s/iter; left time: 736.4151s
	iters: 500, epoch: 1 | loss: 0.4704730
	speed: 0.1339s/iter; left time: 700.6319s
Epoch: 1 cost time: 85.89477109909058
Epoch: 1, Steps: 573 | Train Loss: 0.5707601 Vali Loss: 0.4938704 Test Loss: 0.1980591
Validation loss decreased (inf --> 0.493870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9996209
	speed: 1.7917s/iter; left time: 9062.2158s
	iters: 200, epoch: 2 | loss: 0.4038312
	speed: 0.1416s/iter; left time: 702.2447s
	iters: 300, epoch: 2 | loss: 0.5314723
	speed: 0.1347s/iter; left time: 654.5011s
	iters: 400, epoch: 2 | loss: 0.6067746
	speed: 0.1343s/iter; left time: 639.2327s
	iters: 500, epoch: 2 | loss: 0.4881788
	speed: 0.1321s/iter; left time: 615.3488s
Epoch: 2 cost time: 79.22645306587219
Epoch: 2, Steps: 573 | Train Loss: 0.5148184 Vali Loss: 0.4676586 Test Loss: 0.1925109
Validation loss decreased (0.493870 --> 0.467659).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3639393
	speed: 1.8177s/iter; left time: 8152.2197s
	iters: 200, epoch: 3 | loss: 0.8030812
	speed: 0.1236s/iter; left time: 542.1147s
	iters: 300, epoch: 3 | loss: 0.4330395
	speed: 0.1323s/iter; left time: 566.9512s
	iters: 400, epoch: 3 | loss: 0.3381301
	speed: 0.1352s/iter; left time: 565.7036s
	iters: 500, epoch: 3 | loss: 0.4366034
	speed: 0.1353s/iter; left time: 552.7088s
Epoch: 3 cost time: 76.19381332397461
Epoch: 3, Steps: 573 | Train Loss: 0.5025229 Vali Loss: 0.4673821 Test Loss: 0.1911104
Validation loss decreased (0.467659 --> 0.467382).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4567714
	speed: 1.8034s/iter; left time: 7054.9152s
	iters: 200, epoch: 4 | loss: 0.4709346
	speed: 0.1416s/iter; left time: 539.9180s
	iters: 300, epoch: 4 | loss: 0.4062445
	speed: 0.1439s/iter; left time: 534.1676s
	iters: 400, epoch: 4 | loss: 0.5056884
	speed: 0.1509s/iter; left time: 544.9804s
	iters: 500, epoch: 4 | loss: 0.4028169
	speed: 0.1435s/iter; left time: 503.8190s
Epoch: 4 cost time: 83.83224725723267
Epoch: 4, Steps: 573 | Train Loss: 0.4972476 Vali Loss: 0.4769845 Test Loss: 0.1926107
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5492737
	speed: 1.7869s/iter; left time: 5966.3728s
	iters: 200, epoch: 5 | loss: 0.4269075
	speed: 0.1348s/iter; left time: 436.5585s
	iters: 300, epoch: 5 | loss: 0.3989512
	speed: 0.1342s/iter; left time: 421.3946s
	iters: 400, epoch: 5 | loss: 1.5076878
	speed: 0.1348s/iter; left time: 409.5188s
	iters: 500, epoch: 5 | loss: 0.4514711
	speed: 0.1368s/iter; left time: 402.1623s
Epoch: 5 cost time: 78.78267931938171
Epoch: 5, Steps: 573 | Train Loss: 0.4941692 Vali Loss: 0.4618314 Test Loss: 0.1889686
Validation loss decreased (0.467382 --> 0.461831).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3773569
	speed: 1.7983s/iter; left time: 4974.0327s
	iters: 200, epoch: 6 | loss: 0.4716329
	speed: 0.1239s/iter; left time: 330.3973s
	iters: 300, epoch: 6 | loss: 0.7451174
	speed: 0.1336s/iter; left time: 342.8105s
	iters: 400, epoch: 6 | loss: 0.5204750
	speed: 0.1352s/iter; left time: 333.4391s
	iters: 500, epoch: 6 | loss: 0.3432955
	speed: 0.1354s/iter; left time: 320.2829s
Epoch: 6 cost time: 77.75714683532715
Epoch: 6, Steps: 573 | Train Loss: 0.4923032 Vali Loss: 0.4717568 Test Loss: 0.1912813
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5637047
	speed: 1.7908s/iter; left time: 3927.1564s
	iters: 200, epoch: 7 | loss: 0.3773252
	speed: 0.1409s/iter; left time: 294.9121s
	iters: 300, epoch: 7 | loss: 0.3342824
	speed: 0.1441s/iter; left time: 287.2384s
	iters: 400, epoch: 7 | loss: 0.4461880
	speed: 0.1513s/iter; left time: 286.3559s
	iters: 500, epoch: 7 | loss: 0.3463347
	speed: 0.1461s/iter; left time: 261.9037s
Epoch: 7 cost time: 84.45397591590881
Epoch: 7, Steps: 573 | Train Loss: 0.4914976 Vali Loss: 0.4593460 Test Loss: 0.1890948
Validation loss decreased (0.461831 --> 0.459346).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4898086
	speed: 1.7972s/iter; left time: 2911.4435s
	iters: 200, epoch: 8 | loss: 0.3770343
	speed: 0.1322s/iter; left time: 200.9492s
	iters: 300, epoch: 8 | loss: 0.3225062
	speed: 0.1346s/iter; left time: 191.0905s
	iters: 400, epoch: 8 | loss: 0.3433460
	speed: 0.1351s/iter; left time: 178.3008s
	iters: 500, epoch: 8 | loss: 0.9115864
	speed: 0.1339s/iter; left time: 163.3510s
Epoch: 8 cost time: 78.43257355690002
Epoch: 8, Steps: 573 | Train Loss: 0.4911962 Vali Loss: 0.4642790 Test Loss: 0.1897262
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4601060
	speed: 1.7495s/iter; left time: 1831.7772s
	iters: 200, epoch: 9 | loss: 0.5292835
	speed: 0.1375s/iter; left time: 130.1984s
	iters: 300, epoch: 9 | loss: 0.4078284
	speed: 0.1358s/iter; left time: 115.0616s
	iters: 400, epoch: 9 | loss: 0.7893124
	speed: 0.1422s/iter; left time: 106.2388s
	iters: 500, epoch: 9 | loss: 0.4684327
	speed: 0.1343s/iter; left time: 86.9074s
Epoch: 9 cost time: 80.29867815971375
Epoch: 9, Steps: 573 | Train Loss: 0.4908255 Vali Loss: 0.4611757 Test Loss: 0.1896662
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3817514
	speed: 1.7916s/iter; left time: 849.2096s
	iters: 200, epoch: 10 | loss: 0.3453451
	speed: 0.1341s/iter; left time: 50.1538s
	iters: 300, epoch: 10 | loss: 0.9082964
	speed: 0.1372s/iter; left time: 37.6054s
	iters: 400, epoch: 10 | loss: 0.7819796
	speed: 0.1404s/iter; left time: 24.4364s
	iters: 500, epoch: 10 | loss: 0.4075120
	speed: 0.1447s/iter; left time: 10.7075s
Epoch: 10 cost time: 80.8599145412445
Epoch: 10, Steps: 573 | Train Loss: 0.4913655 Vali Loss: 0.4631501 Test Loss: 0.1892403
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1890946477651596, mae:0.22759108245372772
