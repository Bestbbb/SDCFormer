Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='weather_96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=10, pred_len=96, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.7443508
	speed: 0.2360s/iter; left time: 13497.4772s
	iters: 200, epoch: 1 | loss: 0.7511716
	speed: 0.1956s/iter; left time: 11171.0592s
	iters: 300, epoch: 1 | loss: 0.6553524
	speed: 0.1927s/iter; left time: 10986.7777s
	iters: 400, epoch: 1 | loss: 0.6604938
	speed: 0.1942s/iter; left time: 11049.5216s
	iters: 500, epoch: 1 | loss: 0.6737171
	speed: 0.1925s/iter; left time: 10933.9099s
Epoch: 1 cost time: 115.17892360687256
Epoch: 1, Steps: 573 | Train Loss: 0.8930362 Vali Loss: 0.5581838 Test Loss: 0.2136264
Validation loss decreased (inf --> 0.558184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6937007
	speed: 1.7696s/iter; left time: 100206.3486s
	iters: 200, epoch: 2 | loss: 0.8102078
	speed: 0.1888s/iter; left time: 10673.2861s
	iters: 300, epoch: 2 | loss: 0.6807675
	speed: 0.1985s/iter; left time: 11198.1487s
	iters: 400, epoch: 2 | loss: 0.9300168
	speed: 0.1914s/iter; left time: 10781.0370s
	iters: 500, epoch: 2 | loss: 0.6946767
	speed: 0.1965s/iter; left time: 11046.8992s
Epoch: 2 cost time: 112.25134444236755
Epoch: 2, Steps: 573 | Train Loss: 0.7753688 Vali Loss: 0.5314695 Test Loss: 0.2087914
Validation loss decreased (0.558184 --> 0.531469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6825153
	speed: 1.7711s/iter; left time: 99276.9416s
	iters: 200, epoch: 3 | loss: 0.8216928
	speed: 0.1889s/iter; left time: 10571.2850s
	iters: 300, epoch: 3 | loss: 1.1438189
	speed: 0.1921s/iter; left time: 10730.7319s
	iters: 400, epoch: 3 | loss: 0.6980353
	speed: 0.1912s/iter; left time: 10660.7085s
	iters: 500, epoch: 3 | loss: 0.6986727
	speed: 0.1915s/iter; left time: 10655.2095s
Epoch: 3 cost time: 111.87260365486145
Epoch: 3, Steps: 573 | Train Loss: 0.7465253 Vali Loss: 0.5437797 Test Loss: 0.2095798
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6278547
	speed: 1.7813s/iter; left time: 98827.8732s
	iters: 200, epoch: 4 | loss: 0.6499365
	speed: 0.1898s/iter; left time: 10510.1213s
	iters: 300, epoch: 4 | loss: 0.6692672
	speed: 0.1908s/iter; left time: 10547.5630s
	iters: 400, epoch: 4 | loss: 0.5929214
	speed: 0.1875s/iter; left time: 10345.4066s
	iters: 500, epoch: 4 | loss: 0.8294569
	speed: 0.1921s/iter; left time: 10583.5374s
Epoch: 4 cost time: 110.53507781028748
Epoch: 4, Steps: 573 | Train Loss: 0.7294927 Vali Loss: 0.5113355 Test Loss: 0.2029276
Validation loss decreased (0.531469 --> 0.511335).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6425954
	speed: 1.7703s/iter; left time: 97206.7593s
	iters: 200, epoch: 5 | loss: 0.6334287
	speed: 0.1922s/iter; left time: 10532.5313s
	iters: 300, epoch: 5 | loss: 0.6664289
	speed: 0.1882s/iter; left time: 10294.8177s
	iters: 400, epoch: 5 | loss: 1.0117520
	speed: 0.1941s/iter; left time: 10601.4289s
	iters: 500, epoch: 5 | loss: 0.7445981
	speed: 0.1912s/iter; left time: 10423.7298s
Epoch: 5 cost time: 111.12087321281433
Epoch: 5, Steps: 573 | Train Loss: 0.7241406 Vali Loss: 0.5133103 Test Loss: 0.2030199
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6132463
	speed: 1.7613s/iter; left time: 95700.0055s
	iters: 200, epoch: 6 | loss: 0.5735812
	speed: 0.1929s/iter; left time: 10461.5563s
	iters: 300, epoch: 6 | loss: 0.5729406
	speed: 0.1945s/iter; left time: 10531.7092s
	iters: 400, epoch: 6 | loss: 1.1118222
	speed: 0.1906s/iter; left time: 10299.3001s
	iters: 500, epoch: 6 | loss: 0.6242635
	speed: 0.1901s/iter; left time: 10251.9541s
Epoch: 6 cost time: 111.86115050315857
Epoch: 6, Steps: 573 | Train Loss: 0.7200554 Vali Loss: 0.5073260 Test Loss: 0.2014728
Validation loss decreased (0.511335 --> 0.507326).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6015428
	speed: 1.7711s/iter; left time: 95220.2032s
	iters: 200, epoch: 7 | loss: 0.6599361
	speed: 0.1888s/iter; left time: 10133.3321s
	iters: 300, epoch: 7 | loss: 0.7119271
	speed: 0.1880s/iter; left time: 10072.4942s
	iters: 400, epoch: 7 | loss: 1.1146843
	speed: 0.1878s/iter; left time: 10042.0854s
	iters: 500, epoch: 7 | loss: 0.4973191
	speed: 0.1920s/iter; left time: 10248.2080s
Epoch: 7 cost time: 110.31578326225281
Epoch: 7, Steps: 573 | Train Loss: 0.7184342 Vali Loss: 0.5117925 Test Loss: 0.2023439
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6676351
	speed: 1.7729s/iter; left time: 94302.2636s
	iters: 200, epoch: 8 | loss: 1.1437228
	speed: 0.1893s/iter; left time: 10047.4836s
	iters: 300, epoch: 8 | loss: 0.5639141
	speed: 0.1924s/iter; left time: 10197.9165s
	iters: 400, epoch: 8 | loss: 0.6768619
	speed: 0.1882s/iter; left time: 9955.1279s
	iters: 500, epoch: 8 | loss: 0.7076730
	speed: 0.1889s/iter; left time: 9971.3041s
Epoch: 8 cost time: 110.40888047218323
Epoch: 8, Steps: 573 | Train Loss: 0.7169748 Vali Loss: 0.5109106 Test Loss: 0.2024426
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7250694
	speed: 1.7735s/iter; left time: 93315.5555s
	iters: 200, epoch: 9 | loss: 0.7456528
	speed: 0.1910s/iter; left time: 10030.9699s
	iters: 300, epoch: 9 | loss: 0.7125427
	speed: 0.1875s/iter; left time: 9826.3754s
	iters: 400, epoch: 9 | loss: 0.5893829
	speed: 0.1903s/iter; left time: 9957.8576s
	iters: 500, epoch: 9 | loss: 0.7969062
	speed: 0.1872s/iter; left time: 9777.0661s
Epoch: 9 cost time: 110.47659707069397
Epoch: 9, Steps: 573 | Train Loss: 0.7160113 Vali Loss: 0.5070255 Test Loss: 0.2021086
Validation loss decreased (0.507326 --> 0.507026).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7159661
	speed: 1.7642s/iter; left time: 91817.9497s
	iters: 200, epoch: 10 | loss: 1.0939298
	speed: 0.1888s/iter; left time: 9805.2577s
	iters: 300, epoch: 10 | loss: 0.6201988
	speed: 0.1900s/iter; left time: 9850.8728s
	iters: 400, epoch: 10 | loss: 0.7532193
	speed: 0.1910s/iter; left time: 9882.8282s
	iters: 500, epoch: 10 | loss: 0.6581150
	speed: 0.1957s/iter; left time: 10104.6498s
Epoch: 10 cost time: 110.73880672454834
Epoch: 10, Steps: 573 | Train Loss: 0.7151009 Vali Loss: 0.5110770 Test Loss: 0.2019751
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.7233766
	speed: 1.7706s/iter; left time: 91132.9677s
	iters: 200, epoch: 11 | loss: 0.5202197
	speed: 0.1895s/iter; left time: 9736.4067s
	iters: 300, epoch: 11 | loss: 0.6458622
	speed: 0.1935s/iter; left time: 9919.6678s
	iters: 400, epoch: 11 | loss: 0.6908987
	speed: 0.1923s/iter; left time: 9840.7884s	
	iters: 500, epoch: 11 | loss: 0.5943981
	speed: 0.1920s/iter; left time: 9804.2677s
Epoch: 11 cost time: 111.63138246536255
Epoch: 11, Steps: 573 | Train Loss: 0.7158475 Vali Loss: 0.5126033 Test Loss: 0.2020257
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.9021252
	speed: 1.7781s/iter; left time: 90501.2563s
	iters: 200, epoch: 12 | loss: 0.6415721
	speed: 0.1907s/iter; left time: 9687.5457s
	iters: 300, epoch: 12 | loss: 0.5133614
	speed: 0.1913s/iter; left time: 9700.1539s
	iters: 400, epoch: 12 | loss: 0.5548705
	speed: 0.1890s/iter; left time: 9564.7680s
	iters: 500, epoch: 12 | loss: 0.6763374
	speed: 0.1908s/iter; left time: 9634.7685s
Epoch: 12 cost time: 110.9904727935791
Epoch: 12, Steps: 573 | Train Loss: 0.7157400 Vali Loss: 0.5101284 Test Loss: 0.2019719
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.7090318
	speed: 1.7685s/iter; left time: 88998.4028s
	iters: 200, epoch: 13 | loss: 0.6667076
	speed: 0.1930s/iter; left time: 9692.3652s
	iters: 300, epoch: 13 | loss: 0.6797014
	speed: 0.1898s/iter; left time: 9513.2950s
	iters: 400, epoch: 13 | loss: 0.5696789
	speed: 0.1917s/iter; left time: 9589.8485s
	iters: 500, epoch: 13 | loss: 0.7422242
	speed: 0.1915s/iter; left time: 9559.6820s
Epoch: 13 cost time: 111.3398163318634
Epoch: 13, Steps: 573 | Train Loss: 0.7154066 Vali Loss: 0.5121940 Test Loss: 0.2019294
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 1.0325509
	speed: 1.7636s/iter; left time: 87742.9244s
	iters: 200, epoch: 14 | loss: 0.5931609
	speed: 0.1904s/iter; left time: 9452.1094s
	iters: 300, epoch: 14 | loss: 1.0693247
	speed: 0.1913s/iter; left time: 9479.0958s
	iters: 400, epoch: 14 | loss: 0.5940902
	speed: 0.1893s/iter; left time: 9360.2139s
	iters: 500, epoch: 14 | loss: 0.6500760
	speed: 0.1923s/iter; left time: 9488.7721s
Epoch: 14 cost time: 111.24839782714844
Epoch: 14, Steps: 573 | Train Loss: 0.7153714 Vali Loss: 0.5102658 Test Loss: 0.2019142
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.4790571
	speed: 1.7815s/iter; left time: 87614.7417s
	iters: 200, epoch: 15 | loss: 0.6890079
	speed: 0.1907s/iter; left time: 9359.0542s
	iters: 300, epoch: 15 | loss: 0.6239018
	speed: 0.1944s/iter; left time: 9521.1116s
	iters: 400, epoch: 15 | loss: 0.5432112
	speed: 0.1961s/iter; left time: 9586.1215s
	iters: 500, epoch: 15 | loss: 0.6600397
	speed: 0.1921s/iter; left time: 9371.6868s
Epoch: 15 cost time: 112.00652408599854
Epoch: 15, Steps: 573 | Train Loss: 0.7143987 Vali Loss: 0.5094679 Test Loss: 0.2019162
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.7007997
	speed: 1.7652s/iter; left time: 85797.1789s
	iters: 200, epoch: 16 | loss: 1.1997939
	speed: 0.1931s/iter; left time: 9367.2005s
	iters: 300, epoch: 16 | loss: 0.5538902
	speed: 0.1894s/iter; left time: 9167.5009s
	iters: 400, epoch: 16 | loss: 1.0579937
	speed: 0.1884s/iter; left time: 9100.6011s
	iters: 500, epoch: 16 | loss: 0.7679664
	speed: 0.1902s/iter; left time: 9169.4230s
Epoch: 16 cost time: 110.78846406936646
Epoch: 16, Steps: 573 | Train Loss: 0.7156119 Vali Loss: 0.5119236 Test Loss: 0.2019137
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.7710375
	speed: 1.7789s/iter; left time: 85444.0837s
	iters: 200, epoch: 17 | loss: 1.0708609
	speed: 0.1898s/iter; left time: 9096.6024s
	iters: 300, epoch: 17 | loss: 1.6827686
	speed: 0.1942s/iter; left time: 9291.2389s
	iters: 400, epoch: 17 | loss: 0.6102515
	speed: 0.1885s/iter; left time: 8997.6223s
	iters: 500, epoch: 17 | loss: 0.6596130
	speed: 0.1908s/iter; left time: 9088.3443s
Epoch: 17 cost time: 111.6703109741211
Epoch: 17, Steps: 573 | Train Loss: 0.7152144 Vali Loss: 0.5099782 Test Loss: 0.2019155
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.6029640
	speed: 1.7684s/iter; left time: 83929.7227s
	iters: 200, epoch: 18 | loss: 0.5650792
	speed: 0.1892s/iter; left time: 8962.6302s
	iters: 300, epoch: 18 | loss: 0.6559262
	speed: 0.1941s/iter; left time: 9172.7721s
	iters: 400, epoch: 18 | loss: 0.8092461
	speed: 0.1891s/iter; left time: 8919.9603s
	iters: 500, epoch: 18 | loss: 1.1738745
	speed: 0.1916s/iter; left time: 9016.1325s
Epoch: 18 cost time: 111.07055902481079
Epoch: 18, Steps: 573 | Train Loss: 0.7141058 Vali Loss: 0.5073692 Test Loss: 0.2019162
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.6378119
	speed: 1.7765s/iter; left time: 83295.1258s
	iters: 200, epoch: 19 | loss: 0.4777620
	speed: 0.1880s/iter; left time: 8795.5854s
	iters: 300, epoch: 19 | loss: 0.6324545
	speed: 0.1893s/iter; left time: 8835.8449s
	iters: 400, epoch: 19 | loss: 0.6036876
	speed: 0.1894s/iter; left time: 8822.4172s
	iters: 500, epoch: 19 | loss: 0.6707413
	speed: 0.1884s/iter; left time: 8759.7133s
Epoch: 19 cost time: 110.18062734603882
Epoch: 19, Steps: 573 | Train Loss: 0.7143911 Vali Loss: 0.5106785 Test Loss: 0.2019163
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.20210862159729004, mae:0.23682901263237
