Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=4, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=7, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/ETT-small/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12003
val 1647
test 3389
	iters: 100, epoch: 1 | loss: 0.1454545
	speed: 0.1380s/iter; left time: 4127.1447s
	iters: 200, epoch: 1 | loss: 0.1521853
	speed: 0.1128s/iter; left time: 3360.2004s
	iters: 300, epoch: 1 | loss: 0.2224748
	speed: 0.1145s/iter; left time: 3400.1393s
	iters: 400, epoch: 1 | loss: 0.1404752
	speed: 0.1153s/iter; left time: 3412.9155s
	iters: 500, epoch: 1 | loss: 0.3565223
	speed: 0.1181s/iter; left time: 3485.0818s
	iters: 600, epoch: 1 | loss: 2.5240657
	speed: 0.1169s/iter; left time: 3437.3494s
	iters: 700, epoch: 1 | loss: 0.1415377
	speed: 0.1189s/iter; left time: 3482.7647s
	iters: 800, epoch: 1 | loss: 0.2265349
	speed: 0.1172s/iter; left time: 3421.8023s
	iters: 900, epoch: 1 | loss: 0.1847389
	speed: 0.1177s/iter; left time: 3426.4364s
	iters: 1000, epoch: 1 | loss: 0.1548086
	speed: 0.1174s/iter; left time: 3405.4162s
	iters: 1100, epoch: 1 | loss: 0.2706905
	speed: 0.1174s/iter; left time: 3393.4002s
	iters: 1200, epoch: 1 | loss: 0.2339810
	speed: 0.1169s/iter; left time: 3365.8936s
	iters: 1300, epoch: 1 | loss: 0.1050960
	speed: 0.1178s/iter; left time: 3380.6374s
	iters: 1400, epoch: 1 | loss: 0.0952878
	speed: 0.1172s/iter; left time: 3352.6083s
	iters: 1500, epoch: 1 | loss: 0.2272105
	speed: 0.1167s/iter; left time: 3327.2581s
	iters: 1600, epoch: 1 | loss: 0.1618585
	speed: 0.1192s/iter; left time: 3385.4471s
	iters: 1700, epoch: 1 | loss: 0.1322687
	speed: 0.1160s/iter; left time: 3281.7851s
	iters: 1800, epoch: 1 | loss: 0.1317367
	speed: 0.1157s/iter; left time: 3263.5692s
	iters: 1900, epoch: 1 | loss: 0.1687557
	speed: 0.1192s/iter; left time: 3349.8829s
	iters: 2000, epoch: 1 | loss: 0.2122599
	speed: 0.1179s/iter; left time: 3301.6186s
	iters: 2100, epoch: 1 | loss: 0.2791907
	speed: 0.1170s/iter; left time: 3263.2732s
	iters: 2200, epoch: 1 | loss: 0.0690147
	speed: 0.1168s/iter; left time: 3246.8311s
	iters: 2300, epoch: 1 | loss: 0.3945240
	speed: 0.1165s/iter; left time: 3228.2963s
	iters: 2400, epoch: 1 | loss: 0.1422103
	speed: 0.1175s/iter; left time: 3243.3443s
	iters: 2500, epoch: 1 | loss: 0.1345843
	speed: 0.1176s/iter; left time: 3234.1923s
	iters: 2600, epoch: 1 | loss: 0.4688659
	speed: 0.1155s/iter; left time: 3165.2210s
	iters: 2700, epoch: 1 | loss: 0.2622649
	speed: 0.1172s/iter; left time: 3199.5254s
	iters: 2800, epoch: 1 | loss: 0.5072093
	speed: 0.1181s/iter; left time: 3211.6701s
	iters: 2900, epoch: 1 | loss: 0.1713535
	speed: 0.1180s/iter; left time: 3196.7841s
	iters: 3000, epoch: 1 | loss: 0.1893626
	speed: 0.1160s/iter; left time: 3131.5546s
Epoch: 1 cost time: 353.2711217403412
Epoch: 1, Steps: 3000 | Train Loss: 0.3314287 Vali Loss: 0.2743518 Test Loss: 0.1887955
Validation loss decreased (inf --> 0.274352).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1825728
	speed: 0.4219s/iter; left time: 11349.5095s
	iters: 200, epoch: 2 | loss: 0.1494505
	speed: 0.1161s/iter; left time: 3112.1062s
	iters: 300, epoch: 2 | loss: 0.5674941
	speed: 0.1171s/iter; left time: 3126.0699s
	iters: 400, epoch: 2 | loss: 0.1599106
	speed: 0.1176s/iter; left time: 3128.5071s
	iters: 500, epoch: 2 | loss: 0.3080884
	speed: 0.1174s/iter; left time: 3111.3182s
	iters: 600, epoch: 2 | loss: 0.1060761
	speed: 0.1158s/iter; left time: 3056.1638s
	iters: 700, epoch: 2 | loss: 0.1557355
	speed: 0.1189s/iter; left time: 3126.5419s
	iters: 800, epoch: 2 | loss: 0.5237197
	speed: 0.1172s/iter; left time: 3069.7416s
	iters: 900, epoch: 2 | loss: 0.1771640
	speed: 0.1184s/iter; left time: 3091.3025s
	iters: 1000, epoch: 2 | loss: 0.3000229
	speed: 0.1163s/iter; left time: 3023.3627s
	iters: 1100, epoch: 2 | loss: 0.0944834
	speed: 0.1169s/iter; left time: 3029.0231s
	iters: 1200, epoch: 2 | loss: 0.3356163
	speed: 0.1165s/iter; left time: 3004.5944s
	iters: 1300, epoch: 2 | loss: 0.5072541
	speed: 0.1207s/iter; left time: 3102.5451s
	iters: 1400, epoch: 2 | loss: 0.0888453
	speed: 0.1173s/iter; left time: 3001.7295s
	iters: 1500, epoch: 2 | loss: 0.1737570
	speed: 0.1164s/iter; left time: 2968.0696s
	iters: 1600, epoch: 2 | loss: 1.4663802
	speed: 0.1163s/iter; left time: 2953.7911s
	iters: 1700, epoch: 2 | loss: 0.5088413
	speed: 0.1164s/iter; left time: 2944.7671s
	iters: 1800, epoch: 2 | loss: 0.1131281
	speed: 0.1188s/iter; left time: 2994.3092s
	iters: 1900, epoch: 2 | loss: 0.1619942
	speed: 0.1199s/iter; left time: 3010.0735s
	iters: 2000, epoch: 2 | loss: 0.1281543
	speed: 0.1165s/iter; left time: 2913.7063s
	iters: 2100, epoch: 2 | loss: 0.1673363
	speed: 0.1167s/iter; left time: 2905.9263s
	iters: 2200, epoch: 2 | loss: 2.0486012
	speed: 0.1154s/iter; left time: 2862.9612s
	iters: 2300, epoch: 2 | loss: 0.3160474
	speed: 0.1156s/iter; left time: 2855.3465s
	iters: 2400, epoch: 2 | loss: 0.0907910
	speed: 0.1171s/iter; left time: 2879.9835s
	iters: 2500, epoch: 2 | loss: 0.2842108
	speed: 0.1161s/iter; left time: 2844.5458s
	iters: 2600, epoch: 2 | loss: 0.5237915
	speed: 0.1166s/iter; left time: 2844.7311s
	iters: 2700, epoch: 2 | loss: 0.4140863
	speed: 0.1172s/iter; left time: 2847.7638s
	iters: 2800, epoch: 2 | loss: 0.1224171
	speed: 0.1168s/iter; left time: 2825.5459s
	iters: 2900, epoch: 2 | loss: 0.9254849
	speed: 0.1165s/iter; left time: 2807.2267s
	iters: 3000, epoch: 2 | loss: 0.2479664
	speed: 0.1203s/iter; left time: 2886.8397s
Epoch: 2 cost time: 353.01655530929565
Epoch: 2, Steps: 3000 | Train Loss: 0.3159078 Vali Loss: 0.2762148 Test Loss: 0.1940901
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1321409
	speed: 0.4185s/iter; left time: 10002.2514s
	iters: 200, epoch: 3 | loss: 0.1125276
	speed: 0.1186s/iter; left time: 2822.7212s
	iters: 300, epoch: 3 | loss: 0.2704608
	speed: 0.1157s/iter; left time: 2741.5746s
	iters: 400, epoch: 3 | loss: 0.0978167
	speed: 0.1183s/iter; left time: 2790.8246s
	iters: 500, epoch: 3 | loss: 0.1246856
	speed: 0.1209s/iter; left time: 2841.3621s
	iters: 600, epoch: 3 | loss: 0.2025783
	speed: 0.1172s/iter; left time: 2743.0419s
	iters: 700, epoch: 3 | loss: 0.1182965
	speed: 0.1176s/iter; left time: 2740.4566s
	iters: 800, epoch: 3 | loss: 0.2114006
	speed: 0.1147s/iter; left time: 2660.6431s
	iters: 900, epoch: 3 | loss: 0.1906086
	speed: 0.1151s/iter; left time: 2659.1128s
	iters: 1000, epoch: 3 | loss: 0.1831072
	speed: 0.1161s/iter; left time: 2670.7567s
	iters: 1100, epoch: 3 | loss: 0.0831597
	speed: 0.1164s/iter; left time: 2666.5068s
	iters: 1200, epoch: 3 | loss: 0.1059018
	speed: 0.1160s/iter; left time: 2644.1179s
	iters: 1300, epoch: 3 | loss: 0.1895830
	speed: 0.1167s/iter; left time: 2648.4923s
	iters: 1400, epoch: 3 | loss: 0.0850933
	speed: 0.1170s/iter; left time: 2644.5791s
	iters: 1500, epoch: 3 | loss: 0.1943668
	speed: 0.1165s/iter; left time: 2620.6941s
	iters: 1600, epoch: 3 | loss: 0.1187554
	speed: 0.1169s/iter; left time: 2618.5923s
	iters: 1700, epoch: 3 | loss: 0.0872881
	speed: 0.1180s/iter; left time: 2631.0839s
	iters: 1800, epoch: 3 | loss: 0.2829831
	speed: 0.1196s/iter; left time: 2655.5476s
	iters: 1900, epoch: 3 | loss: 0.2057200
	speed: 0.1206s/iter; left time: 2665.3282s
	iters: 2000, epoch: 3 | loss: 0.1381963
	speed: 0.1190s/iter; left time: 2618.9152s
	iters: 2100, epoch: 3 | loss: 0.1447020
	speed: 0.1146s/iter; left time: 2508.9817s
	iters: 2200, epoch: 3 | loss: 0.8486739
	speed: 0.1184s/iter; left time: 2580.6195s
	iters: 2300, epoch: 3 | loss: 1.0937996
	speed: 0.1157s/iter; left time: 2510.3062s
	iters: 2400, epoch: 3 | loss: 0.1011785
	speed: 0.1161s/iter; left time: 2506.8429s
	iters: 2500, epoch: 3 | loss: 0.3346302
	speed: 0.1158s/iter; left time: 2488.8016s
	iters: 2600, epoch: 3 | loss: 0.5435494
	speed: 0.1168s/iter; left time: 2500.3946s
	iters: 2700, epoch: 3 | loss: 0.2376385
	speed: 0.1192s/iter; left time: 2539.5430s
	iters: 2800, epoch: 3 | loss: 0.1661366
	speed: 0.1206s/iter; left time: 2557.7556s
	iters: 2900, epoch: 3 | loss: 0.4278318
	speed: 0.1193s/iter; left time: 2517.7763s
	iters: 3000, epoch: 3 | loss: 0.1059830
	speed: 0.1158s/iter; left time: 2431.0180s
Epoch: 3 cost time: 353.3221986293793
Epoch: 3, Steps: 3000 | Train Loss: 0.2868729 Vali Loss: 0.2743835 Test Loss: 0.1851221
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3457383
	speed: 0.4173s/iter; left time: 8722.6423s
	iters: 200, epoch: 4 | loss: 0.2572459
	speed: 0.1133s/iter; left time: 2356.6858s
	iters: 300, epoch: 4 | loss: 0.2943751
	speed: 0.1155s/iter; left time: 2390.9999s
	iters: 400, epoch: 4 | loss: 0.2307040
	speed: 0.1195s/iter; left time: 2460.9897s
	iters: 500, epoch: 4 | loss: 0.5204666
	speed: 0.1172s/iter; left time: 2402.8175s
	iters: 600, epoch: 4 | loss: 0.4807554
	speed: 0.1182s/iter; left time: 2411.8033s
	iters: 700, epoch: 4 | loss: 0.1018800
	speed: 0.1170s/iter; left time: 2376.0489s
	iters: 800, epoch: 4 | loss: 0.2774485
	speed: 0.1170s/iter; left time: 2363.2100s
	iters: 900, epoch: 4 | loss: 0.4486126
	speed: 0.1160s/iter; left time: 2330.8449s
	iters: 1000, epoch: 4 | loss: 0.1485548
	speed: 0.1161s/iter; left time: 2322.4628s
	iters: 1100, epoch: 4 | loss: 0.5220874
	speed: 0.1162s/iter; left time: 2311.7559s
	iters: 1200, epoch: 4 | loss: 0.5969598
	speed: 0.1157s/iter; left time: 2290.5967s
	iters: 1300, epoch: 4 | loss: 0.9532102
	speed: 0.1191s/iter; left time: 2347.0755s
	iters: 1400, epoch: 4 | loss: 0.5172808
	speed: 0.1176s/iter; left time: 2305.8206s
	iters: 1500, epoch: 4 | loss: 0.1618587
	speed: 0.1163s/iter; left time: 2267.4326s
	iters: 1600, epoch: 4 | loss: 0.1965059
	speed: 0.1172s/iter; left time: 2274.4345s
	iters: 1700, epoch: 4 | loss: 0.3717958
	speed: 0.1168s/iter; left time: 2254.3304s
	iters: 1800, epoch: 4 | loss: 0.2127208
	speed: 0.1176s/iter; left time: 2258.7255s
	iters: 1900, epoch: 4 | loss: 0.4365070
	speed: 0.1196s/iter; left time: 2283.9489s
	iters: 2000, epoch: 4 | loss: 0.4550516
	speed: 0.1153s/iter; left time: 2191.7038s
	iters: 2100, epoch: 4 | loss: 0.1820607
	speed: 0.1157s/iter; left time: 2186.0852s
	iters: 2200, epoch: 4 | loss: 0.1464192
	speed: 0.1173s/iter; left time: 2204.6882s
	iters: 2300, epoch: 4 | loss: 0.1659750
	speed: 0.1195s/iter; left time: 2235.3794s
	iters: 2400, epoch: 4 | loss: 0.2049816
	speed: 0.1175s/iter; left time: 2185.1925s
	iters: 2500, epoch: 4 | loss: 0.1078121
	speed: 0.1159s/iter; left time: 2143.8510s
	iters: 2600, epoch: 4 | loss: 0.1969677
	speed: 0.1196s/iter; left time: 2200.0909s
	iters: 2700, epoch: 4 | loss: 0.2264462
	speed: 0.1202s/iter; left time: 2200.1745s
	iters: 2800, epoch: 4 | loss: 0.8547238
	speed: 0.1167s/iter; left time: 2123.3463s
	iters: 2900, epoch: 4 | loss: 0.2109675
	speed: 0.1196s/iter; left time: 2165.0554s
	iters: 3000, epoch: 4 | loss: 0.3133762
	speed: 0.1160s/iter; left time: 2087.5837s
Epoch: 4 cost time: 352.6070599555969
Epoch: 4, Steps: 3000 | Train Loss: 0.2678952 Vali Loss: 0.2561014 Test Loss: 0.1797108
Validation loss decreased (0.274352 --> 0.256101).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1527848
	speed: 0.4154s/iter; left time: 7436.3721s
	iters: 200, epoch: 5 | loss: 0.0895178
	speed: 0.1120s/iter; left time: 1992.9500s
	iters: 300, epoch: 5 | loss: 0.1321115
	speed: 0.1124s/iter; left time: 1989.4923s
	iters: 400, epoch: 5 | loss: 1.3125489
	speed: 0.1113s/iter; left time: 1958.7042s
	iters: 500, epoch: 5 | loss: 0.4294175
	speed: 0.1171s/iter; left time: 2049.4796s
	iters: 600, epoch: 5 | loss: 0.2099697
	speed: 0.1173s/iter; left time: 2040.6916s
	iters: 700, epoch: 5 | loss: 0.1940560
	speed: 0.1184s/iter; left time: 2049.0856s
	iters: 800, epoch: 5 | loss: 0.1399961
	speed: 0.1194s/iter; left time: 2053.2396s
	iters: 900, epoch: 5 | loss: 0.7355149
	speed: 0.1189s/iter; left time: 2033.5919s
	iters: 1000, epoch: 5 | loss: 0.4082066
	speed: 0.1168s/iter; left time: 1986.0869s
	iters: 1100, epoch: 5 | loss: 0.0945919
	speed: 0.1165s/iter; left time: 1968.8926s
	iters: 1200, epoch: 5 | loss: 0.2179999
	speed: 0.1168s/iter; left time: 1962.7848s
	iters: 1300, epoch: 5 | loss: 0.4181321
	speed: 0.1158s/iter; left time: 1933.5413s
	iters: 1400, epoch: 5 | loss: 0.2035805
	speed: 0.1119s/iter; left time: 1858.1637s
	iters: 1500, epoch: 5 | loss: 0.1275131
	speed: 0.1145s/iter; left time: 1890.0782s
	iters: 1600, epoch: 5 | loss: 0.0950242
	speed: 0.1139s/iter; left time: 1867.7247s
	iters: 1700, epoch: 5 | loss: 0.3867370
	speed: 0.1121s/iter; left time: 1828.1517s
	iters: 1800, epoch: 5 | loss: 0.1633435
	speed: 0.1129s/iter; left time: 1828.8990s
	iters: 1900, epoch: 5 | loss: 0.1956379
	speed: 0.1177s/iter; left time: 1894.4477s
	iters: 2000, epoch: 5 | loss: 0.0775266
	speed: 0.1183s/iter; left time: 1893.2466s
	iters: 2100, epoch: 5 | loss: 0.3257295
	speed: 0.1165s/iter; left time: 1852.1434s
	iters: 2200, epoch: 5 | loss: 0.4653088
	speed: 0.1150s/iter; left time: 1817.1125s
	iters: 2300, epoch: 5 | loss: 1.0974674
	speed: 0.1152s/iter; left time: 1808.7710s
	iters: 2400, epoch: 5 | loss: 0.2144973
	speed: 0.1129s/iter; left time: 1760.6643s
	iters: 2500, epoch: 5 | loss: 0.1860240
	speed: 0.1153s/iter; left time: 1787.1509s
	iters: 2600, epoch: 5 | loss: 0.5259716
	speed: 0.1154s/iter; left time: 1777.5032s
	iters: 2700, epoch: 5 | loss: 0.1178023
	speed: 0.1157s/iter; left time: 1770.1620s
	iters: 2800, epoch: 5 | loss: 0.1269130
	speed: 0.1185s/iter; left time: 1800.8443s
	iters: 2900, epoch: 5 | loss: 0.1732300
	speed: 0.1163s/iter; left time: 1756.3832s
	iters: 3000, epoch: 5 | loss: 0.4637780
	speed: 0.1164s/iter; left time: 1745.8918s
Epoch: 5 cost time: 347.6318211555481
Epoch: 5, Steps: 3000 | Train Loss: 0.2571309 Vali Loss: 0.2605948 Test Loss: 0.1815039
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3124461
	speed: 0.4087s/iter; left time: 6090.1569s
	iters: 200, epoch: 6 | loss: 0.2831702
	speed: 0.1166s/iter; left time: 1725.3888s
	iters: 300, epoch: 6 | loss: 0.2257447
	speed: 0.1172s/iter; left time: 1723.6888s
	iters: 400, epoch: 6 | loss: 0.2376676
	speed: 0.1175s/iter; left time: 1716.0191s
	iters: 500, epoch: 6 | loss: 0.2234717
	speed: 0.1176s/iter; left time: 1705.7325s
	iters: 600, epoch: 6 | loss: 0.1798805
	speed: 0.1187s/iter; left time: 1710.1131s
	iters: 700, epoch: 6 | loss: 0.8326163
	speed: 0.1164s/iter; left time: 1664.5306s
	iters: 800, epoch: 6 | loss: 0.0737146
	speed: 0.1204s/iter; left time: 1709.5518s
	iters: 900, epoch: 6 | loss: 0.3482810
	speed: 0.1175s/iter; left time: 1657.3744s
	iters: 1000, epoch: 6 | loss: 0.0983676
	speed: 0.1156s/iter; left time: 1618.5650s
	iters: 1100, epoch: 6 | loss: 0.3173092
	speed: 0.1177s/iter; left time: 1636.8212s
	iters: 1200, epoch: 6 | loss: 0.0892037
	speed: 0.1162s/iter; left time: 1603.9244s
	iters: 1300, epoch: 6 | loss: 0.1288677
	speed: 0.1164s/iter; left time: 1595.1731s
	iters: 1400, epoch: 6 | loss: 0.1175360
	speed: 0.1167s/iter; left time: 1587.1339s
	iters: 1500, epoch: 6 | loss: 0.1523594
	speed: 0.1166s/iter; left time: 1574.8094s
	iters: 1600, epoch: 6 | loss: 0.5169739
	speed: 0.1186s/iter; left time: 1589.9329s
	iters: 1700, epoch: 6 | loss: 0.2697881
	speed: 0.1238s/iter; left time: 1646.9696s
	iters: 1800, epoch: 6 | loss: 0.0924023
	speed: 0.1196s/iter; left time: 1579.4778s
	iters: 1900, epoch: 6 | loss: 0.1425745
	speed: 0.1164s/iter; left time: 1525.4584s
	iters: 2000, epoch: 6 | loss: 0.2537317
	speed: 0.1156s/iter; left time: 1503.0220s
	iters: 2100, epoch: 6 | loss: 0.1072870
	speed: 0.1170s/iter; left time: 1509.7174s
	iters: 2200, epoch: 6 | loss: 0.2016571
	speed: 0.1162s/iter; left time: 1487.5524s
	iters: 2300, epoch: 6 | loss: 0.1673203
	speed: 0.1146s/iter; left time: 1455.6180s
	iters: 2400, epoch: 6 | loss: 0.0786736
	speed: 0.1181s/iter; left time: 1488.3330s
	iters: 2500, epoch: 6 | loss: 0.2137351
	speed: 0.1142s/iter; left time: 1427.2247s
	iters: 2600, epoch: 6 | loss: 0.1126480
	speed: 0.1162s/iter; left time: 1441.5455s
	iters: 2700, epoch: 6 | loss: 0.3651727
	speed: 0.1164s/iter; left time: 1431.5178s
	iters: 2800, epoch: 6 | loss: 0.3523706
	speed: 0.1173s/iter; left time: 1430.6917s
	iters: 2900, epoch: 6 | loss: 0.5352153
	speed: 0.1163s/iter; left time: 1407.2031s
	iters: 3000, epoch: 6 | loss: 1.1237454
	speed: 0.1152s/iter; left time: 1382.2654s
Epoch: 6 cost time: 352.78948950767517
Epoch: 6, Steps: 3000 | Train Loss: 0.2517547 Vali Loss: 0.2596225 Test Loss: 0.1786173
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2416311
	speed: 0.4158s/iter; left time: 4948.1389s
	iters: 200, epoch: 7 | loss: 0.3660423
	speed: 0.1169s/iter; left time: 1379.0043s
	iters: 300, epoch: 7 | loss: 0.2051978
	speed: 0.1174s/iter; left time: 1373.6099s
	iters: 400, epoch: 7 | loss: 0.2871068
	speed: 0.1196s/iter; left time: 1387.4277s
	iters: 500, epoch: 7 | loss: 0.1140773
	speed: 0.1140s/iter; left time: 1311.3589s
	iters: 600, epoch: 7 | loss: 0.2219636
	speed: 0.1167s/iter; left time: 1330.5965s
	iters: 700, epoch: 7 | loss: 0.4860443
	speed: 0.1171s/iter; left time: 1323.2376s
	iters: 800, epoch: 7 | loss: 0.0816084
	speed: 0.1159s/iter; left time: 1298.4886s
	iters: 900, epoch: 7 | loss: 0.3593011
	speed: 0.1148s/iter; left time: 1274.2896s
	iters: 1000, epoch: 7 | loss: 0.1048645
	speed: 0.1176s/iter; left time: 1293.8933s
	iters: 1100, epoch: 7 | loss: 0.0842356
	speed: 0.1169s/iter; left time: 1273.7852s
	iters: 1200, epoch: 7 | loss: 0.1300979
	speed: 0.1164s/iter; left time: 1256.9557s
	iters: 1300, epoch: 7 | loss: 0.1197524
	speed: 0.1168s/iter; left time: 1250.2365s
	iters: 1400, epoch: 7 | loss: 0.2435768
	speed: 0.1168s/iter; left time: 1237.7626s
	iters: 1500, epoch: 7 | loss: 0.6471282
	speed: 0.1179s/iter; left time: 1238.5233s
	iters: 1600, epoch: 7 | loss: 0.4281711
	speed: 0.1155s/iter; left time: 1201.1275s
	iters: 1700, epoch: 7 | loss: 0.2030682
	speed: 0.1180s/iter; left time: 1215.3635s
	iters: 1800, epoch: 7 | loss: 0.1159377
	speed: 0.1186s/iter; left time: 1209.8977s
	iters: 1900, epoch: 7 | loss: 0.3213686
	speed: 0.1183s/iter; left time: 1194.6770s
	iters: 2000, epoch: 7 | loss: 0.2273181
	speed: 0.1175s/iter; left time: 1174.7938s
	iters: 2100, epoch: 7 | loss: 0.1129875
	speed: 0.1172s/iter; left time: 1159.9340s
	iters: 2200, epoch: 7 | loss: 0.2098787
	speed: 0.1144s/iter; left time: 1121.0346s
	iters: 2300, epoch: 7 | loss: 0.2999962
	speed: 0.1183s/iter; left time: 1147.3760s
	iters: 2400, epoch: 7 | loss: 0.1554310
	speed: 0.1183s/iter; left time: 1135.6017s
	iters: 2500, epoch: 7 | loss: 0.2881051
	speed: 0.1165s/iter; left time: 1107.0904s
	iters: 2600, epoch: 7 | loss: 0.1019300
	speed: 0.1186s/iter; left time: 1114.7566s
	iters: 2700, epoch: 7 | loss: 0.2374302
	speed: 0.1163s/iter; left time: 1081.8882s
	iters: 2800, epoch: 7 | loss: 0.0726632
	speed: 0.1164s/iter; left time: 1070.8004s
	iters: 2900, epoch: 7 | loss: 0.1547260
	speed: 0.1174s/iter; left time: 1068.5628s
	iters: 3000, epoch: 7 | loss: 0.0952374
	speed: 0.1166s/iter; left time: 1049.8529s
Epoch: 7 cost time: 352.0714523792267
Epoch: 7, Steps: 3000 | Train Loss: 0.2496162 Vali Loss: 0.2570385 Test Loss: 0.1785659
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3389
test shape: (3389, 1, 96, 7) (3389, 1, 96, 7)
test shape: (3389, 96, 7) (3389, 96, 7)
mse:0.17971080541610718, mae:0.2864389717578888
