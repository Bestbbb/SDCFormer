Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=21, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=21, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=21, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='96_720', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=720, root_path='./dataset/weather/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_96_720_MyformerV2_custom_ftM_sl96_ll48_pl720_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8504263
	speed: 0.6342s/iter; left time: 3507.5928s
	iters: 200, epoch: 1 | loss: 0.9373344
	speed: 0.5937s/iter; left time: 3224.6062s
	iters: 300, epoch: 1 | loss: 0.6659074
	speed: 0.5936s/iter; left time: 3164.7035s
	iters: 400, epoch: 1 | loss: 0.8469086
	speed: 0.5944s/iter; left time: 3109.3727s
	iters: 500, epoch: 1 | loss: 0.5908396
	speed: 0.5995s/iter; left time: 3076.0477s
Epoch: 1 cost time: 338.88421535491943
Epoch: 1, Steps: 563 | Train Loss: 0.7406070 Vali Loss: 0.7352827 Test Loss: 0.3606561
Validation loss decreased (inf --> 0.735283).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7475042
	speed: 2.1865s/iter; left time: 10862.2851s
	iters: 200, epoch: 2 | loss: 0.7430893
	speed: 0.5619s/iter; left time: 2735.2734s
	iters: 300, epoch: 2 | loss: 0.7578390
	speed: 0.5788s/iter; left time: 2759.5489s
	iters: 400, epoch: 2 | loss: 0.6468704
	speed: 0.5941s/iter; left time: 2773.2694s
	iters: 500, epoch: 2 | loss: 0.7370224
	speed: 0.5979s/iter; left time: 2731.1960s
Epoch: 2 cost time: 325.49236607551575EEpoch: 2, Steps: 563 | Train Loss: 0.7077014 Vali Loss: 0.7123507 Test Loss: 0.3541047
Validation loss decreased (0.735283 --> 0.712351).  Saving model ...
Updating learning rate to 5e-05		iters: 100, epoch: 3 | loss: 0.7430058
	speed: 2.2245s/iter; left time: 9798.7298s		iters: 200, epoch: 3 | loss: 0.6952770
	speed: 0.5943s/iter; left time: 2558.4558s		iters: 300, epoch: 3 | loss: 0.5689295
	speed: 0.5970s/iter; left time: 2510.2493s		iters: 400, epoch: 3 | loss: 0.6826401
	speed: 0.5945s/iter; left time: 2440.2336s		iters: 500, epoch: 3 | loss: 0.7236463
	speed: 0.6000s/iter; left time: 2403.1640s
Epoch: 3 cost time: 336.44589257240295EEpoch: 3, Steps: 563 | Train Loss: 0.6852658 Vali Loss: 0.6987112 Test Loss: 0.3497095
Validation loss decreased (0.712351 --> 0.698711).  Saving model ...
Updating learning rate to 2.5e-05		iters: 100, epoch: 4 | loss: 0.7176428
	speed: 2.2441s/iter; left time: 8621.7219s		iters: 200, epoch: 4 | loss: 0.6589446
	speed: 0.5934s/iter; left time: 2220.3412s		iters: 300, epoch: 4 | loss: 0.6794983
	speed: 0.5922s/iter; left time: 2156.6841s		iters: 400, epoch: 4 | loss: 0.6609709
	speed: 0.5767s/iter; left time: 2042.7946s		iters: 500, epoch: 4 | loss: 0.6577107
	speed: 0.5720s/iter; left time: 1968.9890s
Epoch: 4 cost time: 329.6198992729187
Epoch: 4, Steps: 563 | Train Loss: 0.6743801 Vali Loss: 0.6867590 Test Loss: 0.3466517
Validation loss decreased (0.698711 --> 0.686759).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7748441
	speed: 2.2380s/iter; left time: 7338.5475s
	iters: 200, epoch: 5 | loss: 0.6116449
	speed: 0.5925s/iter; left time: 1883.6543s
	iters: 300, epoch: 5 | loss: 0.5732521
	speed: 0.5938s/iter; left time: 1828.2267s
	iters: 400, epoch: 5 | loss: 0.6988462
	speed: 0.5941s/iter; left time: 1769.7276s
	iters: 500, epoch: 5 | loss: 0.6433043
	speed: 0.5965s/iter; left time: 1717.2591s
Epoch: 5 cost time: 334.1005883216858
Epoch: 5, Steps: 563 | Train Loss: 0.6699681 Vali Loss: 0.6810115 Test Loss: 0.3455825
Validation loss decreased (0.686759 --> 0.681011).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6040996
	speed: 2.2282s/iter; left time: 6051.8117s
	iters: 200, epoch: 6 | loss: 0.5501378
	speed: 0.5950s/iter; left time: 1556.5828s
	iters: 300, epoch: 6 | loss: 0.7960894
	speed: 0.5957s/iter; left time: 1498.7161s
	iters: 400, epoch: 6 | loss: 0.6816119
	speed: 0.5963s/iter; left time: 1440.5816s
	iters: 500, epoch: 6 | loss: 0.6467023
	speed: 0.5990s/iter; left time: 1387.3555s
Epoch: 6 cost time: 334.28118801116943EEpoch: 6, Steps: 563 | Train Loss: 0.6676249 Vali Loss: 0.6810765 Test Loss: 0.3452569
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06		iters: 100, epoch: 7 | loss: 0.6514968
	speed: 2.0762s/iter; left time: 4470.0978s		iters: 200, epoch: 7 | loss: 0.6291509
	speed: 0.5959s/iter; left time: 1223.4098s		iters: 300, epoch: 7 | loss: 0.7324209
	speed: 0.5948s/iter; left time: 1161.7061s		iters: 400, epoch: 7 | loss: 0.7435284
	speed: 0.5944s/iter; left time: 1101.4916s		iters: 500, epoch: 7 | loss: 0.7251965
	speed: 0.5969s/iter; left time: 1046.3533s
Epoch: 7 cost time: 334.527987241745
Epoch: 7, Steps: 563 | Train Loss: 0.6663469 Vali Loss: 0.6803696 Test Loss: 0.3454649
Validation loss decreased (0.681011 --> 0.680370).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6942087
	speed: 2.2374s/iter; left time: 3557.4025s
	iters: 200, epoch: 8 | loss: 0.6371789
	speed: 0.5932s/iter; left time: 883.8164s
	iters: 300, epoch: 8 | loss: 0.6319942
	speed: 0.5944s/iter; left time: 826.2595s
	iters: 400, epoch: 8 | loss: 0.7034515
	speed: 0.5950s/iter; left time: 767.5318s
	iters: 500, epoch: 8 | loss: 0.6499613
	speed: 0.5986s/iter; left time: 712.2809s
Epoch: 8 cost time: 336.03763818740845
Epoch: 8, Steps: 563 | Train Loss: 0.6657505 Vali Loss: 0.6808512 Test Loss: 0.3454645
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6871700
	speed: 2.2220s/iter; left time: 2281.9801s
	iters: 200, epoch: 9 | loss: 0.7606204
	speed: 0.5861s/iter; left time: 543.2963s
	iters: 300, epoch: 9 | loss: 0.6148387
	speed: 0.5657s/iter; left time: 467.8629s
	iters: 400, epoch: 9 | loss: 0.7125614
	speed: 0.5632s/iter; left time: 409.4754s
	iters: 500, epoch: 9 | loss: 0.5221100
	speed: 0.5933s/iter; left time: 371.9965s
Epoch: 9 cost time: 328.5076017379761EEpoch: 9, Steps: 563 | Train Loss: 0.6654096 Vali Loss: 0.6804880 Test Loss: 0.3452522
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07		iters: 100, epoch: 10 | loss: 0.7456173
	speed: 2.2276s/iter; left time: 1033.6294s		iters: 200, epoch: 10 | loss: 0.5688213
	speed: 0.5953s/iter; left time: 216.6714s		iters: 300, epoch: 10 | loss: 0.6960447
	speed: 0.5944s/iter; left time: 156.9153s		iters: 400, epoch: 10 | loss: 0.7246845
	speed: 0.5932s/iter; left time: 97.2911s		iters: 500, epoch: 10 | loss: 0.7092346
	speed: 0.5943s/iter; left time: 38.0354s
Epoch: 10 cost time: 335.2611544132232EpEpoch: 10, Steps: 563 | Train Loss: 0.6653402 Vali Loss: 0.6801905 Test Loss: 0.3452136
Validation loss decreased (0.680370 --> 0.680191).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_96_720_MyformerV2_custom_ftM_sl96_ll48_pl720_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 982tetest shape: (9820, 1, 720, 21) (9820, 1, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.34521275758743286, mae:0.34616976976394653
