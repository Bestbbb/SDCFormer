Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=321, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=321, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=321, factor=3, features='M', freq='h', gpu=0, head_dropout=0.0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='MyformerV2', model_id='96_96', moving_avg=25, multi_moving_avg=[13, 17, 21, 25, 29, 31], n_heads=4, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_len=16, patience=3, pred_len=96, root_path='./dataset/electricity/', seasonal_patterns='Monthly', seq_len=96, show_model=False, stride=8, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2671386
	speed: 0.7107s/iter; left time: 8017.4254s
	iters: 200, epoch: 1 | loss: 0.2635473
	speed: 0.8571s/iter; left time: 9583.6457s
	iters: 300, epoch: 1 | loss: 0.2748870
	speed: 0.8879s/iter; left time: 9839.1047s
	iters: 400, epoch: 1 | loss: 0.2894505
	speed: 0.8295s/iter; left time: 9108.2409s
	iters: 500, epoch: 1 | loss: 0.2806173
	speed: 0.6473s/iter; left time: 7042.9600s
	iters: 600, epoch: 1 | loss: 0.2356737
	speed: 0.7152s/iter; left time: 7710.4679s
	iters: 700, epoch: 1 | loss: 0.2951992
	speed: 0.9026s/iter; left time: 9640.9599s
	iters: 800, epoch: 1 | loss: 0.2929977
	speed: 0.8911s/iter; left time: 9428.5255s
	iters: 900, epoch: 1 | loss: 0.2617463
	speed: 0.7342s/iter; left time: 7695.6275s
	iters: 1000, epoch: 1 | loss: 0.2863965
	speed: 0.6056s/iter; left time: 6287.0896s
	iters: 1100, epoch: 1 | loss: 0.2641655
	speed: 0.8030s/iter; left time: 8255.2591s
Epoch: 1 cost time: 893.3029475212097
Epoch: 1, Steps: 1138 | Train Loss: 0.2860826 Vali Loss: 0.1758988 Test Loss: 0.2002371
Validation loss decreased (inf --> 0.175899).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2627985
	speed: 2.8342s/iter; left time: 28747.4738s
	iters: 200, epoch: 2 | loss: 0.2229465
	speed: 0.7947s/iter; left time: 7981.2714s
	iters: 300, epoch: 2 | loss: 0.2742171
	speed: 0.8937s/iter; left time: 8885.6357s
	iters: 400, epoch: 2 | loss: 0.2640773
	speed: 0.8260s/iter; left time: 8130.1512s
	iters: 500, epoch: 2 | loss: 0.2677776
	speed: 0.6797s/iter; left time: 6622.4716s
	iters: 600, epoch: 2 | loss: 0.2273287
	speed: 0.6745s/iter; left time: 6504.6633s
	iters: 700, epoch: 2 | loss: 0.2762457
	speed: 0.8284s/iter; left time: 7905.7038s
	iters: 800, epoch: 2 | loss: 0.2223158
	speed: 0.8900s/iter; left time: 8404.2109s
	iters: 900, epoch: 2 | loss: 0.2813656
	speed: 0.7651s/iter; left time: 7148.4235s
	iters: 1000, epoch: 2 | loss: 0.2385942
	speed: 0.6637s/iter; left time: 6134.9043s
	iters: 1100, epoch: 2 | loss: 0.2663561
	speed: 0.6887s/iter; left time: 6297.1815s
Epoch: 2 cost time: 868.6527438163757
Epoch: 2, Steps: 1138 | Train Loss: 0.2648256 Vali Loss: 0.1665872 Test Loss: 0.1885904
Validation loss decreased (0.175899 --> 0.166587).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2981917
	speed: 2.9053s/iter; left time: 26161.9339s
	iters: 200, epoch: 3 | loss: 0.2657458
	speed: 0.7065s/iter; left time: 6291.4465s
	iters: 300, epoch: 3 | loss: 0.2792185
	speed: 0.8731s/iter; left time: 7687.6333s
	iters: 400, epoch: 3 | loss: 0.2968833
	speed: 0.9188s/iter; left time: 7998.0040s
	iters: 500, epoch: 3 | loss: 0.2483479
	speed: 0.7309s/iter; left time: 6289.1002s
	iters: 600, epoch: 3 | loss: 0.2816582
	speed: 0.6482s/iter; left time: 5512.9679s
	iters: 700, epoch: 3 | loss: 0.2320078
	speed: 0.7349s/iter; left time: 6177.1667s
	iters: 800, epoch: 3 | loss: 0.2830493
	speed: 0.9126s/iter; left time: 7579.2667s
	iters: 900, epoch: 3 | loss: 0.2649046
	speed: 0.8718s/iter; left time: 7153.4285s
	iters: 1000, epoch: 3 | loss: 0.2473827
	speed: 0.7054s/iter; left time: 5717.0368s
	iters: 1100, epoch: 3 | loss: 0.2377475
	speed: 0.6666s/iter; left time: 5336.1889s
Epoch: 3 cost time: 873.4430415630341
Epoch: 3, Steps: 1138 | Train Loss: 0.2568195 Vali Loss: 0.1639461 Test Loss: 0.1862509
Validation loss decreased (0.166587 --> 0.163946).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2543079
	speed: 2.9687s/iter; left time: 23354.9466s
	iters: 200, epoch: 4 | loss: 0.2329090
	speed: 0.6202s/iter; left time: 4816.7336s
	iters: 300, epoch: 4 | loss: 0.2357772
	speed: 0.5966s/iter; left time: 4574.0983s
	iters: 400, epoch: 4 | loss: 0.2743984
	speed: 0.5863s/iter; left time: 4436.7650s
	iters: 500, epoch: 4 | loss: 0.2973338
	speed: 0.5869s/iter; left time: 4382.4175s
	iters: 600, epoch: 4 | loss: 0.2606300
	speed: 0.6438s/iter; left time: 4742.7915s
	iters: 700, epoch: 4 | loss: 0.2570576
	speed: 0.8534s/iter; left time: 6201.5779s
	iters: 800, epoch: 4 | loss: 0.2540218
	speed: 0.8909s/iter; left time: 6385.3488s
	iters: 900, epoch: 4 | loss: 0.2411013
	speed: 0.8916s/iter; left time: 6301.1190s
	iters: 1000, epoch: 4 | loss: 0.2325241
	speed: 0.7971s/iter; left time: 5553.1607s
	iters: 1100, epoch: 4 | loss: 0.2738016
	speed: 0.6513s/iter; left time: 4472.8071s
Epoch: 4 cost time: 807.4234364032745
Epoch: 4, Steps: 1138 | Train Loss: 0.2521406 Vali Loss: 0.1562289 Test Loss: 0.1771737
Validation loss decreased (0.163946 --> 0.156229).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2509656
	speed: 3.0184s/iter; left time: 20310.6631s
	iters: 200, epoch: 5 | loss: 0.2662977
	speed: 0.8130s/iter; left time: 5389.4756s
	iters: 300, epoch: 5 | loss: 0.3172304
	speed: 0.6559s/iter; left time: 4282.3083s
	iters: 400, epoch: 5 | loss: 0.2214230
	speed: 0.6803s/iter; left time: 4373.8319s
	iters: 500, epoch: 5 | loss: 0.2714480
	speed: 0.8898s/iter; left time: 5631.5941s
	iters: 600, epoch: 5 | loss: 0.2620357
	speed: 0.8935s/iter; left time: 5565.5645s
	iters: 700, epoch: 5 | loss: 0.2661287
	speed: 0.8944s/iter; left time: 5481.5947s
	iters: 800, epoch: 5 | loss: 0.2638162
	speed: 0.7881s/iter; left time: 4751.1836s
	iters: 900, epoch: 5 | loss: 0.2406817
	speed: 0.6290s/iter; left time: 3729.2749s
	iters: 1000, epoch: 5 | loss: 0.2928565
	speed: 0.7479s/iter; left time: 4359.6832s
	iters: 1100, epoch: 5 | loss: 0.2418578
	speed: 0.8907s/iter; left time: 5102.9152s
Epoch: 5 cost time: 913.6451945304871
Epoch: 5, Steps: 1138 | Train Loss: 0.2490613 Vali Loss: 0.1560661 Test Loss: 0.1780370
Validation loss decreased (0.156229 --> 0.156066).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2897959
	speed: 2.9051s/iter; left time: 16242.3968s
	iters: 200, epoch: 6 | loss: 0.2266109
	speed: 0.7432s/iter; left time: 4080.6368s
	iters: 300, epoch: 6 | loss: 0.2469940
	speed: 0.8922s/iter; left time: 4810.0916s
	iters: 400, epoch: 6 | loss: 0.2408195
	speed: 0.8949s/iter; left time: 4734.8159s
	iters: 500, epoch: 6 | loss: 0.2588487
	speed: 0.8912s/iter; left time: 4626.0093s
	iters: 600, epoch: 6 | loss: 0.2119139
	speed: 0.7182s/iter; left time: 3656.3769s
	iters: 700, epoch: 6 | loss: 0.2487001
	speed: 0.6489s/iter; left time: 3238.7474s
	iters: 800, epoch: 6 | loss: 0.2955002
	speed: 0.7869s/iter; left time: 3848.5134s
	iters: 900, epoch: 6 | loss: 0.2570419
	speed: 0.8926s/iter; left time: 4276.4099s
	iters: 1000, epoch: 6 | loss: 0.2374437
	speed: 0.8979s/iter; left time: 4212.0338s
	iters: 1100, epoch: 6 | loss: 0.2393601
	speed: 0.8753s/iter; left time: 4018.6124s
Epoch: 6 cost time: 917.6902892589569
Epoch: 6, Steps: 1138 | Train Loss: 0.2475387 Vali Loss: 0.1548812 Test Loss: 0.1760911
Validation loss decreased (0.156066 --> 0.154881).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2133064
	speed: 2.7842s/iter; left time: 12398.2059s
	iters: 200, epoch: 7 | loss: 0.2626432
	speed: 0.8945s/iter; left time: 3893.9188s
	iters: 300, epoch: 7 | loss: 0.2461406
	speed: 0.8720s/iter; left time: 3708.6758s
	iters: 400, epoch: 7 | loss: 0.2675796
	speed: 0.6715s/iter; left time: 2788.6999s
	iters: 500, epoch: 7 | loss: 0.2427741
	speed: 0.6547s/iter; left time: 2653.6105s
	iters: 600, epoch: 7 | loss: 0.2640781
	speed: 0.8653s/iter; left time: 3420.7179s
	iters: 700, epoch: 7 | loss: 0.2125066
	speed: 0.8916s/iter; left time: 3435.3463s
	iters: 800, epoch: 7 | loss: 0.2519868
	speed: 0.8909s/iter; left time: 3343.6934s
	iters: 900, epoch: 7 | loss: 0.2960783
	speed: 0.8237s/iter; left time: 3009.1176s
	iters: 1000, epoch: 7 | loss: 0.2558978
	speed: 0.6580s/iter; left time: 2337.9889s
	iters: 1100, epoch: 7 | loss: 0.2244908
	speed: 0.7130s/iter; left time: 2461.9291s
Epoch: 7 cost time: 919.7820334434509
Epoch: 7, Steps: 1138 | Train Loss: 0.2467209 Vali Loss: 0.1543076 Test Loss: 0.1754224
Validation loss decreased (0.154881 --> 0.154308).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2603237
	speed: 3.1499s/iter; left time: 10441.9995s
	iters: 200, epoch: 8 | loss: 0.2801762
	speed: 0.6540s/iter; left time: 2102.5196s
	iters: 300, epoch: 8 | loss: 0.2099133
	speed: 0.6968s/iter; left time: 2170.4730s
	iters: 400, epoch: 8 | loss: 0.2755415
	speed: 0.8940s/iter; left time: 2695.4256s
	iters: 500, epoch: 8 | loss: 0.2462017
	speed: 0.8935s/iter; left time: 2604.6775s
	iters: 600, epoch: 8 | loss: 0.2511134
	speed: 0.8899s/iter; left time: 2505.0792s
	iters: 700, epoch: 8 | loss: 0.2989527
	speed: 0.7842s/iter; left time: 2129.1835s
	iters: 800, epoch: 8 | loss: 0.2536734
	speed: 0.6374s/iter; left time: 1666.9193s
	iters: 900, epoch: 8 | loss: 0.2615982
	speed: 0.6171s/iter; left time: 1552.0610s
	iters: 1000, epoch: 8 | loss: 0.2772786
	speed: 0.5863s/iter; left time: 1415.9007s
	iters: 1100, epoch: 8 | loss: 0.2353766
	speed: 0.5856s/iter; left time: 1355.5673s
Epoch: 8 cost time: 830.9158158302307
Epoch: 8, Steps: 1138 | Train Loss: 0.2463739 Vali Loss: 0.1535362 Test Loss: 0.1742893
Validation loss decreased (0.154308 --> 0.153536).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2426489
	speed: 2.0139s/iter; left time: 4384.3503s
	iters: 200, epoch: 9 | loss: 0.2706760
	speed: 0.5415s/iter; left time: 1124.7403s
	iters: 300, epoch: 9 | loss: 0.2242478
	speed: 0.5407s/iter; left time: 1069.0379s
	iters: 400, epoch: 9 | loss: 0.2739030
	speed: 0.5426s/iter; left time: 1018.4816s
	iters: 500, epoch: 9 | loss: 0.2282818
	speed: 0.5417s/iter; left time: 962.6429s
	iters: 600, epoch: 9 | loss: 0.2480476
	speed: 0.5420s/iter; left time: 908.8754s
	iters: 700, epoch: 9 | loss: 0.2431464
	speed: 0.5408s/iter; left time: 852.8817s
	iters: 800, epoch: 9 | loss: 0.2773111
	speed: 0.5389s/iter; left time: 796.0103s
	iters: 900, epoch: 9 | loss: 0.2477324
	speed: 0.5403s/iter; left time: 743.9663s
	iters: 1000, epoch: 9 | loss: 0.2296488
	speed: 0.5445s/iter; left time: 695.3438s
	iters: 1100, epoch: 9 | loss: 0.2611107
	speed: 0.5439s/iter; left time: 640.2150s
Epoch: 9 cost time: 618.6490476131439
Epoch: 9, Steps: 1138 | Train Loss: 0.2461462 Vali Loss: 0.1536838 Test Loss: 0.1746940
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2347108
	speed: 1.9832s/iter; left time: 2060.5110s
	iters: 200, epoch: 10 | loss: 0.2384617
	speed: 0.5413s/iter; left time: 508.2469s
	iters: 300, epoch: 10 | loss: 0.2582587
	speed: 0.5412s/iter; left time: 454.0853s
	iters: 400, epoch: 10 | loss: 0.2608208
	speed: 0.5401s/iter; left time: 399.1450s
	iters: 500, epoch: 10 | loss: 0.2175876
	speed: 0.5412s/iter; left time: 345.7969s
	iters: 600, epoch: 10 | loss: 0.2369796
	speed: 0.5414s/iter; left time: 291.8069s
	iters: 700, epoch: 10 | loss: 0.2410364
	speed: 0.5407s/iter; left time: 237.3768s
	iters: 800, epoch: 10 | loss: 0.2327080
	speed: 0.5406s/iter; left time: 183.2682s
	iters: 900, epoch: 10 | loss: 0.2530871
	speed: 0.5403s/iter; left time: 129.1236s
	iters: 1000, epoch: 10 | loss: 0.2313989
	speed: 0.5415s/iter; left time: 75.2669s
	iters: 1100, epoch: 10 | loss: 0.2681506
	speed: 0.5413s/iter; left time: 21.1114s
Epoch: 10 cost time: 617.6897180080414
Epoch: 10, Steps: 1138 | Train Loss: 0.2460558 Vali Loss: 0.1535328 Test Loss: 0.1743092
Validation loss decreased (0.153536 --> 0.153533).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_96_96_MyformerV2_custom_ftM_sl96_ll48_pl96_dm512_nh4_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 1, 96, 321) (5165, 1, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.1743096262216568, mae:0.2689419090747833
